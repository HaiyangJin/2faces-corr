
# Relationships among effects

## Calculate holistic processing effects

```{r}
# custom function to use linear models to apply the regression method
cal_reg <- function(.data, formula, outvar){
  
  # .data: the input dataframe
  # formula: used in lm()
  # outvar: the column name for the regression effect (residuals) [new column]
  
  # perform linear regression
  lm_tmp <- lm(formula, .data)
  
  # save the residuals
  return(mutate(.data, {{outvar}} := residuals(lm_tmp))) # outvar is a variable
  # return(mutate(.data, "{outvar}" := residuals(lm_tmp))) # outvar is a string
}
```


### Part-whole task

Accuracy
```{r}
pwe_acc <- df_pw %>% 
  group_by(Subject, PW) %>% 
  summarize(acc = mean(Correct),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = PW, values_from = acc) %>% 
  mutate(pwe_subt = whole - part) %>% # subtraction
  cal_reg(whole ~ part, pwe_regr) # regression

pwe_acc
```

RT
```{r}
pwe_rt <- df_pw %>% 
  filter(Correct) %>% 
  group_by(Subject, PW) %>% 
  summarize(rt = mean(RT),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = PW, values_from = rt) %>% 
  mutate(pwe_subt = whole - part) %>% # subtraction
  cal_reg(whole ~ part, pwe_regr) # regression

pwe_rt
```

### Standard composite face task
Accuracy
```{r}
scfe_acc <- df_scf %>% 
  group_by(Subject, Alignment) %>% 
  summarize(acc = mean(Correct),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = Alignment, values_from = acc) %>% 
  mutate(scfe_subt = ali - mis) %>% # subtraction
  cal_reg(ali ~ mis, scfe_regr) # regression

scfe_acc
```

RT
```{r}
scfe_rt <- df_scf %>% 
  filter(Correct) %>% 
  group_by(Subject, Alignment) %>% 
  summarize(rt = mean(RT),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = Alignment, values_from = rt) %>% 
  mutate(scfe_subt = ali - mis) %>% # subtraction
  cal_reg(ali ~ mis, scfe_regr) # regression

scfe_rt
```

### Complete composite face task
Sensitivity d'
```{r}
ccfe_d <- df_ccf_iso %>% 
  group_by(Subject, Congruency, Alignment, SD) %>% 
  summarize(count = n(),
            same_adjust = (sum(isSame)+0.5)/(count+1), # Snodgrass & Corwin (1988)
            .groups = "drop") %>% 
  mutate(z = qnorm(same_adjust)) %>% 
  select(-same_adjust) %>% 
  pivot_wider(names_from = "SD", values_from = z) %>% 
  mutate(d = sam - dif) %>% 
  pivot_wider(Subject, names_from = c(Congruency, Alignment), values_from = d) %>% 
  rename(isolated = iso_iso) %>% 
  mutate(fac_subt = con_ali - con_mis, # subtraction
         int_subt = inc_ali - inc_mis, # subtraction
         fac_subt_iso = con_ali - isolated, # subtraction
         int_subt_iso = inc_ali - isolated, # subtraction
         cong_ali_subt = con_ali - inc_ali, # subtraction
         cong_mis_subt = con_mis - inc_mis, # subtraction
         ccfe_subt_subt = cong_ali_subt - cong_mis_subt) %>%  # subtraction
  cal_reg(con_ali ~ con_mis, fac_regr) %>% # regression
  cal_reg(inc_ali ~ inc_mis, int_regr) %>% # regression
  cal_reg(con_ali ~ isolated, fac_regr_iso) %>% # regression
  cal_reg(inc_ali ~ isolated, int_regr_iso) %>% # regression
  cal_reg(con_ali ~ inc_ali, cong_ali_regr) %>% # regression
  cal_reg(con_mis ~ inc_mis, cong_mis_regr) %>% # regression
  cal_reg(cong_ali_subt ~ cong_mis_subt, ccfe_subt_regr) %>% # regression
  cal_reg(cong_ali_regr ~ cong_mis_regr, ccfe_regr_regr) # regression

ccfe_d 
```

RT
```{r}
ccfe_rt <- df_ccf_iso %>% 
  filter(Correct) %>% 
  group_by(Subject, Congruency, Alignment) %>% 
  summarize(rt = mean(RT),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = c(Congruency, Alignment), values_from = rt) %>% 
  rename(isolated = iso_iso) %>% 
  mutate(fac_subt = con_ali - con_mis, # subtraction
         int_subt = inc_ali - inc_mis, # subtraction
         fac_subt_iso = con_ali - isolated, # subtraction
         int_subt_iso = inc_ali - isolated, # subtraction
         cong_ali_subt = con_ali - inc_ali, # subtraction
         cong_mis_subt = con_mis - inc_mis, # subtraction
         ccfe_subt_subt = cong_ali_subt - cong_mis_subt) %>% # subtraction
  cal_reg(con_ali ~ con_mis, fac_regr) %>% # regression
  cal_reg(inc_ali ~ inc_mis, int_regr) %>% # regression
  cal_reg(con_ali ~ isolated, fac_regr_iso) %>% # regression
  cal_reg(inc_ali ~ isolated, int_regr_iso) %>% # regression
  cal_reg(con_ali ~ inc_ali, cong_ali_regr) %>% # regression
  cal_reg(con_mis ~ inc_mis, cong_mis_regr) %>% # regression
  cal_reg(cong_ali_subt ~ cong_mis_subt, ccfe_subt_regr) %>% # regression [first step is subtraction; second step is regression]
  cal_reg(cong_ali_regr ~ cong_mis_regr, ccfe_regr_regr) # regression

ccfe_rt
```


## Reliability of measurement

`psych::splitHalf(..., check.keys=FALSE)` is used to calculate the Guttman's $\lambda_2$ (although it will report results of various methods). Thus, the data have to be prepared to fit the desired structure:

1. The average performance for each `StimGroup` and each participant (for each dependent variable in each task) will be calculated.
2. Then the data needs to be formatted as following, which will be completed later when calculating the reliability for each condition separately.  
- Each matrix is for one condition (and one dependent variable).  
- Each row of the matrix is for one participant.  
- Each column of the matrix is for one `StimGroup`.

```{r}
# a general (custom) function to calculate the reliability for each condition
rel_each <- function(.data, DV, ...){
  
  out <- 
    .data %>%
    filter(...) %>% # to filter out conditions
    pivot_wider(Subject, values_from = all_of(DV), names_from = test_item) %>%
    select(-Subject) %>%
    data.matrix() %>% 
    splitHalf(check.keys=FALSE)
  
  return(out$lambda2) # only output lambda2
}
```

```{r}
# function to calculate the reliability of subtraction scores
rel_sub <- function(re_inte, re_base, raw_inte, raw_base){
  
  # re_inte: the reliability of the condition of interest
  # re_base: the reliability of the baseline condition
  # raw_inte: the raw values for each participant in the condition of interest
  # raw_base: the raw values for each participant in the baseline condition
  
  tmp <- 2*sd(raw_inte)*sd(raw_base)*cor(raw_inte, raw_base)
  
  top <- var(raw_inte) * re_inte$Reliability + var(raw_base) * re_base$Reliability - tmp
  bot <- var(raw_inte) + var(raw_base) - tmp
  
  return(top/bot)
}

```

```{r}
# function to calculate the reliability of regression scores
rel_reg <- function(re_inte, re_base, raw_inte, raw_base){
  
  # re_inte: the reliability of the condition of interest
  # re_base: the reliability of the baseline condition
  # raw_inte: the raw values for each participant in the condition of interest
  # raw_base: the raw values for each participant in the baseline condition
  
  tmp1 <- cor(raw_inte, raw_base)^2
  
  top <- re_inte$Reliability + re_base$Reliability * tmp1 - 2 * tmp1
  bot <- 1 - tmp1
  
  return(top/bot)
}

```

```{r}
# function to calculate the upper boundary of the correlation
upper_boundary <- function(re1, re2){
  # reliability will be set to 0 if it is negative
  return(sqrt(max(re1$Reliability,0) * max(re2$Reliability,0)))
}
```


### Part-whole task

```{r}
# PW
df_pw_rel <- df_pw %>%
  mutate(test_item = paste(str_remove(basename(StudyFace), ".png"), 
                           str_remove(basename(TestFace), ".png"), sep="_"))
```

#### Reliability of each condition

Accuracy for whole
```{r}
rel_pw_acc_w <- .8888 %>%  # rel_each(df_pw_rel, "Correct", PW=="whole") %>%  
  tibble(DV = "acc", Condition = "whole", Approach = "GuttmanL2",  Reliability = .)
rel_pw_acc_w
```

Accuracy for part
```{r}
rel_pw_acc_p <- rel_each(df_pw_rel, "Correct", PW=="part") %>% 
  tibble(DV = "acc", Condition = "part", Approach = "GuttmanL2", Reliability = .)
rel_pw_acc_p
```

RT for whole
```{r}
rel_pw_rt_w <- rel_each(df_pw_rel, "RT", PW=="whole") %>% 
  tibble(DV = "rt", Condition = "whole", Approach = "GuttmanL2", Reliability = .)
rel_pw_rt_w
```

RT for part
```{r}
rel_pw_rt_p <- rel_each(df_pw_rel, "RT", PW=="part") %>% 
  tibble(DV = "rt", Condition = "part", Approach = "GuttmanL2", Reliability = .)
rel_pw_rt_p
```

#### Reliability of the part-whole effect

Subtraction of accuracy
```{r}
rel_pwe_acc_subt <- rel_sub(rel_pw_acc_w, rel_pw_acc_p,
                            pwe_acc$whole, pwe_acc$part) %>% 
  tibble(DV = "acc", Condition = "whole - part", 
         Approach = "Subtraction", Reliability = .)
rel_pwe_acc_subt
```

Regression of accuracy
```{r}
rel_pwe_acc_regr <- rel_reg(rel_pw_acc_w, rel_pw_acc_p,
                            pwe_acc$whole, pwe_acc$part) %>% 
  tibble(DV = "acc", Condition = "whole ~ part", 
         Approach = "Regression", Reliability = .)
rel_pwe_acc_regr
```

Subtraction of RT
```{r}
rel_pwe_rt_subt <- rel_sub(rel_pw_rt_w, rel_pw_rt_p,
                           pwe_rt$whole, pwe_rt$part) %>% 
  tibble(DV = "rt", Condition = "whole - part", 
         Approach = "Subtraction", Reliability = .)
rel_pwe_rt_subt
```

Regression of RT
```{r}
rel_pwe_rt_regr <- rel_reg(rel_pw_rt_w, rel_pw_rt_p,
                           pwe_rt$whole, pwe_rt$part) %>% 
  tibble(DV = "rt", Condition = "whole ~ part", 
         Approach = "Regression", Reliability = .)
rel_pwe_rt_regr
```

#### Interim summary 

```{r}
rel_sum_pw <- bind_rows(rel_pw_acc_w, rel_pw_acc_p, rel_pw_rt_w, rel_pw_rt_p,
                        rel_pwe_acc_subt, rel_pwe_acc_regr, rel_pwe_rt_subt, rel_pwe_rt_regr) %>% 
  mutate(Task="PW", .before=1)
rel_sum_pw
```

### Standard composite face task

```{r}  
# SCF
df_scf_rel <- df_scf %>% 
  group_by(Subject, Alignment) %>% 
  summarize(test_item = 1:n(),
            Correct, RT,
            .groups = "drop") 

str(df_scf_rel)
```

#### Reliability of each condition
Accuracy for aligned
```{r}
rel_scf_acc_a <- rel_each(df_scf_rel, "Correct", Alignment=="ali") %>% 
  tibble(DV = "acc", Condition = "aligned", Approach = "GuttmanL2",  Reliability = .)
rel_scf_acc_a
```

Accuracy for misaligned
```{r}
rel_scf_acc_m <- .8888 %>% # rel_each(df_scf_rel, "Correct", Alignment=="mis") %>% 
  tibble(DV = "acc", Condition = "misaligned", Approach = "GuttmanL2",  Reliability = .)
rel_scf_acc_m
```

RT for aligned
```{r}
rel_scf_rt_a <- rel_each(df_scf_rel, "RT", Alignment=="ali") %>% 
  tibble(DV = "rt", Condition = "aligned", Approach = "GuttmanL2",  Reliability = .)
rel_scf_rt_a
```

RT for misaligned
```{r}
rel_scf_rt_m <- rel_each(df_scf_rel, "RT", Alignment=="mis") %>% 
  tibble(DV = "rt", Condition = "misaligned", Approach = "GuttmanL2",  Reliability = .)
rel_scf_rt_m
```

#### Reliability of the composite effect

Subtraction of accuracy
```{r}
rel_scfe_acc_subt <- rel_sub(rel_scf_acc_a, rel_scf_acc_m, 
                             scfe_acc$ali, scfe_acc$mis) %>% 
  tibble(DV = "acc", Condition = "ali - mis", 
         Approach = "Subtraction", Reliability = .)
rel_scfe_acc_subt
```

Regression of accuracy
```{r}
rel_scfe_acc_regr <- rel_reg(rel_scf_acc_a, rel_scf_acc_m, 
                             scfe_acc$ali, scfe_acc$mis) %>% 
  tibble(DV = "acc", Condition = "ali ~ mis", 
         Approach = "Regression", Reliability = .)
rel_scfe_acc_regr
```

Subtraction of RT
```{r}
rel_scfe_rt_subt <- rel_sub(rel_scf_rt_a, rel_scf_rt_m, 
                            scfe_rt$ali, scfe_rt$mis) %>% 
  tibble(DV = "rt", Condition = "ali - mis", 
         Approach = "Subtraction", Reliability = .)
rel_scfe_rt_subt
```

Regression of RT
```{r}
rel_scfe_rt_regr <- rel_reg(rel_scf_rt_a, rel_scf_rt_m, 
                            scfe_rt$ali, scfe_rt$mis) %>% 
  tibble(DV = "rt", Condition = "ali ~ mis", 
         Approach = "Regression", Reliability = .)
rel_scfe_rt_regr
```

#### Interim summary 

```{r}
rel_sum_scf <- bind_rows(rel_scf_acc_a, rel_scf_acc_m, rel_scf_rt_a, rel_scf_rt_m,
                         rel_scfe_acc_subt, rel_scfe_acc_regr, rel_scfe_rt_subt, rel_scfe_rt_regr) %>% 
  mutate(Task = "SCF", .before =1)
rel_sum_scf
```

### Complete composite face task

```{r}
# CCF
df_ccf_rel <- df_ccf_iso %>% # need to include the isolated condition
  group_by(Subject, Congruency, Alignment) %>% 
  summarize(test_item = 1:n(),
            Correct, RT,
            .groups = "drop") 

str(df_ccf_rel)
```

#### Reliability of each condition

Behavioral choices for congruent aligned
```{r}
rel_ccf_beha_ca <- .8888 %>% # rel_each(df_ccf_rel, "Correct", 
  #Congruency=="con", Alignment=="ali") %>% 
  tibble(DV = "behav", Condition = "con_ali", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_ca
```

Behavioral choices for incongruent aligned
```{r}
rel_ccf_beha_ia <- rel_each(df_ccf_rel, "Correct", 
                            Congruency=="inc", Alignment=="ali") %>% 
  tibble(DV = "behav", Condition = "inc_ali", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_ia
```

Behavioral choices for congruent misaligned
```{r}
rel_ccf_beha_cm <- .8888 %>% # rel_each(df_ccf_rel, "Correct", 
  # Congruency=="con", Alignment=="mis") %>% 
  tibble(DV = "behav", Condition = "con_mis", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_cm
```

Behavioral choices for incongruent misaligned
```{r}
rel_ccf_beha_im <- rel_each(df_ccf_rel, "Correct", 
                            Congruency=="inc", Alignment=="mis") %>% 
  tibble(DV = "behav", Condition = "inc_mis", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_im
```

Behavioral choices for isolated
```{r}
rel_ccf_beha_iso <- .8888 %>%  # rel_each(df_ccf_rel, "Correct", 
  # Congruency=="iso", Alignment=="iso") %>% 
  tibble(DV = "behav", Condition = "isolated", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_iso
```

RT for congruent aligned
```{r}
rel_ccf_rt_ca <- rel_each(df_ccf_rel, "RT", 
                          Congruency=="con", Alignment=="ali") %>% 
  tibble(DV = "rt", Condition = "con_ali", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_ca
```

RT for incongruent aligned
```{r}
rel_ccf_rt_ia <- rel_each(df_ccf_rel, "RT", 
                          Congruency=="inc", Alignment=="ali") %>% 
  tibble(DV = "rt", Condition = "inc_ali", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_ia
```

RT for congruent misaligned
```{r}
rel_ccf_rt_cm <- rel_each(df_ccf_rel, "RT", 
                          Congruency=="con", Alignment=="mis") %>% 
  tibble(DV = "rt", Condition = "con_mis", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_cm
```

RT for incongruent misaligned
```{r}
rel_ccf_rt_im <- rel_each(df_ccf_rel, "RT", 
                          Congruency=="inc", Alignment=="mis") %>% 
  tibble(DV = "rt", Condition = "inc_mis", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_im
```

RT for isolated
```{r}
rel_ccf_rt_iso <- rel_each(df_ccf_rel, "RT", 
                           Congruency=="iso", Alignment=="iso") %>% 
  tibble(DV = "rt", Condition = "isolated", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_iso
```


#### Reliability of facilitation

Subtraction of accuracy (with isolated baselines)
```{r}
rel_fac_beha_iso_subt <- rel_sub(rel_ccf_beha_ca, rel_ccf_beha_iso, 
                                 ccfe_d$con_ali, ccfe_d$isolated) %>% 
  tibble(DV = "d", Condition = "con_ali - isolated", 
         Approach = "Subtraction",  Reliability = .)

rel_fac_beha_iso_subt
```

Regression of accuracy (with isolated baselines)
```{r}
rel_fac_beha_iso_regr <- rel_reg(rel_ccf_beha_ca, rel_ccf_beha_iso, 
                                 ccfe_d$con_ali, ccfe_d$isolated) %>% 
  tibble(DV = "d", Condition = "con_ali ~ isolated", 
         Approach = "Regression",  Reliability = .)

rel_fac_beha_iso_regr
```

Subtraction of RT (with isolated baselines)
```{r}
rel_fac_rt_iso_subt <- rel_sub(rel_ccf_rt_ca, rel_ccf_rt_iso, 
                               ccfe_rt$con_ali, ccfe_rt$isolated) %>% 
  tibble(DV = "rt", Condition = "con_ali - isolated", 
         Approach = "Subtraction",  Reliability = .)

rel_fac_rt_iso_subt
```

Regression of RT (with isolated baselines)
```{r}
rel_fac_rt_iso_regr <- rel_reg(rel_ccf_rt_ca, rel_ccf_rt_iso, 
                               ccfe_rt$con_ali, ccfe_rt$isolated) %>% 
  tibble(DV = "rt", Condition = "con_ali ~ isolated", 
         Approach = "Regression",  Reliability = .)

rel_fac_rt_iso_regr
```

Subtraction of accuracy (with misaligned baselines)
```{r}
rel_fac_beha_subt <- rel_sub(rel_ccf_beha_ca, rel_ccf_beha_cm, 
                             ccfe_d$con_ali, ccfe_d$con_mis) %>% 
  tibble(DV = "d", Condition = "con_ali - con_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_fac_beha_subt
```

Regression of accuracy (with misaligned baselines)
```{r}
rel_fac_beha_regr <- rel_reg(rel_ccf_beha_ca, rel_ccf_beha_cm, 
                             ccfe_d$con_ali, ccfe_d$con_mis) %>% 
  tibble(DV = "d", Condition = "con_ali ~ con_mis", 
         Approach = "Regression",  Reliability = .)

rel_fac_beha_regr
```

Subtraction of RT (with misaligned baselines)
```{r}
rel_fac_rt_subt <- rel_sub(rel_ccf_rt_ca, rel_ccf_rt_cm, 
                           ccfe_rt$con_ali, ccfe_rt$con_mis) %>% 
  tibble(DV = "rt", Condition = "con_ali - con_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_fac_rt_subt
```

Regression of RT (with misaligned baselines)
```{r}
rel_fac_rt_regr <- rel_reg(rel_ccf_rt_ca, rel_ccf_rt_cm, 
                           ccfe_rt$con_ali, ccfe_rt$con_mis) %>% 
  tibble(DV = "rt", Condition = "con_ali ~ con_mis", 
         Approach = "Regression",  Reliability = .)

rel_fac_rt_subt
```


#### Reliability of interference

Subtraction of d (with isolated baselines)
```{r}
rel_int_beha_iso_subt <- rel_sub(rel_ccf_beha_ia, rel_ccf_beha_iso, 
                                 ccfe_d$inc_ali, ccfe_d$isolated) %>% 
  tibble(DV = "d", Condition = "inc_ali - isolated", 
         Approach = "Subtraction",  Reliability = .)

rel_int_beha_iso_subt
```

Regression of d (with isolated baselines)
```{r}
rel_int_beha_iso_regr <- rel_reg(rel_ccf_beha_ia, rel_ccf_beha_iso,
                                 ccfe_d$inc_ali, ccfe_d$isolated) %>% 
  tibble(DV = "d", Condition = "inc_ali ~ isolated", 
         Approach = "Regression",  Reliability = .)

rel_int_beha_iso_regr
```

Subtraction of RT (with isolated baselines)
```{r}
rel_int_rt_iso_subt <- rel_sub(rel_ccf_rt_ia, rel_ccf_rt_iso, 
                               ccfe_rt$inc_ali, ccfe_rt$isolated) %>% 
  tibble(DV = "rt", Condition = "inc_ali - isolated", 
         Approach = "Subtraction",  Reliability = .)

rel_int_rt_iso_subt
```

Regression of RT (with isolated baselines)
```{r}
rel_int_rt_iso_regr <- rel_reg(rel_ccf_rt_ia, rel_ccf_rt_iso, 
                               ccfe_rt$inc_ali, ccfe_rt$isolated) %>% 
  tibble(DV = "rt", Condition = "inc_ali ~ isolated", 
         Approach = "Regression",  Reliability = .)

rel_int_rt_iso_regr
```

Subtraction of d (with misaligned baselines)
```{r}
rel_int_beha_subt <- rel_sub(rel_ccf_beha_ia, rel_ccf_beha_im, 
                             ccfe_d$inc_ali, ccfe_d$inc_mis) %>% 
  tibble(DV = "d", Condition = "inc_ali - inc_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_int_beha_subt
```

Regression of d (with misaligned baselines)
```{r}
rel_int_beha_regr <- rel_reg(rel_ccf_beha_ia, rel_ccf_beha_im,
                             ccfe_d$inc_ali, ccfe_d$inc_mis) %>% 
  tibble(DV = "d", Condition = "inc_ali ~ inc_mis", 
         Approach = "Regression",  Reliability = .)

rel_int_beha_regr
```

Subtraction of RT (with misaligned baselines)
```{r}
rel_int_rt_subt <- rel_sub(rel_ccf_rt_ia, rel_ccf_rt_im, 
                           ccfe_rt$inc_ali, ccfe_rt$inc_mis) %>% 
  tibble(DV = "rt", Condition = "inc_ali - inc_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_int_rt_subt
```

Regression of RT (with misaligned baselines)
```{r}
rel_int_rt_regr <- rel_reg(rel_ccf_rt_ia, rel_ccf_rt_im, 
                           ccfe_rt$inc_ali, ccfe_rt$inc_mis) %>% 
  tibble(DV = "rt", Condition = "inc_ali ~ inc_mis", 
         Approach = "Regression",  Reliability = .)

rel_int_rt_regr
```


#### Reliability of congruency effects

Congruency in d subtraction (aligned)
```{r}
rel_ccf_beha_cong_a_subt <- rel_sub(rel_ccf_beha_ca, rel_ccf_beha_ia, 
                                    ccfe_d$con_ali, ccfe_d$inc_ali) %>% 
  tibble(DV = "d", Condition = "con_ali - inc_ali", 
         Approach = "Subtraction",  Reliability = .)

rel_ccf_beha_cong_a_subt
```

Congruency in d regression (aligned)
```{r}
rel_ccf_beha_cong_a_regr <- rel_reg(rel_ccf_beha_ca, rel_ccf_beha_ia, 
                                    ccfe_d$con_ali, ccfe_d$inc_ali) %>% 
  tibble(DV = "d", Condition = "con_ali ~ inc_ali", 
         Approach = "Regression",  Reliability = .)

rel_ccf_beha_cong_a_regr
```

Congruency in d subtraction (misaligned)
```{r}
rel_ccf_beha_cong_m_subt <- rel_sub(rel_ccf_beha_cm, rel_ccf_beha_im, 
                                    ccfe_d$con_mis, ccfe_d$inc_mis) %>% 
  tibble(DV = "d", Condition = "con_mis - inc_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_ccf_beha_cong_m_subt
```

Congruency in d regression (misaligned)
```{r}
rel_ccf_beha_cong_m_regr <- rel_reg(rel_ccf_beha_cm, rel_ccf_beha_im, 
                                    ccfe_d$con_mis, ccfe_d$inc_mis) %>% 
  tibble(DV = "d", Condition = "con_mis ~ inc_mis", 
         Approach = "Regression",  Reliability = .)

rel_ccf_beha_cong_m_regr
```

Congruency in RT subtraction (aligned)
```{r}
rel_ccf_rt_cong_a_subt <- rel_sub(rel_ccf_rt_ca, rel_ccf_rt_ia, 
                                  ccfe_d$con_ali, ccfe_d$inc_ali) %>% 
  tibble(DV = "rt", Condition = "con_ali - inc_ali", 
         Approach = "Subtraction",  Reliability = .)

rel_ccf_rt_cong_a_subt
```

Congruency in RT regression (aligned)
```{r}
rel_ccf_rt_cong_a_regr <- rel_reg(rel_ccf_rt_ca, rel_ccf_rt_ia, 
                                  ccfe_d$con_ali, ccfe_d$inc_ali) %>% 
  tibble(DV = "rt", Condition = "con_ali ~ inc_ali", 
         Approach = "Regression",  Reliability = .)

rel_ccf_rt_cong_a_regr
```

Congruency in RT subtraction (misaligned)
```{r}
rel_ccf_rt_cong_m_subt <- rel_sub(rel_ccf_rt_cm, rel_ccf_rt_im, 
                                  ccfe_d$con_mis, ccfe_d$inc_mis) %>% 
  tibble(DV = "rt", Condition = "con_mis - inc_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_ccf_rt_cong_m_subt
```

Congruency in RT subtraction (misaligned)
```{r}
rel_ccf_rt_cong_m_regr <- rel_reg(rel_ccf_rt_cm, rel_ccf_rt_im, 
                                  ccfe_d$con_mis, ccfe_d$inc_mis) %>% 
  tibble(DV = "rt", Condition = "con_mis ~ inc_mis", 
         Approach = "Regression",  Reliability = .)

rel_ccf_rt_cong_m_regr
```

#### Reliability of the composite effect

Subtraction of Congruency (composite effect) in d [subtraction of subtraction]
```{r}
rel_ccfe_beha_subt_subt <- rel_sub(rel_ccf_beha_cong_a_subt, rel_ccf_beha_cong_m_subt, 
                                   ccfe_d$cong_ali_subt, ccfe_d$cong_mis_subt) %>% 
  tibble(DV = "d", Condition = "(con_ali - inc_ali) - (con_mis - inc_mis)", 
         Approach = "Subtraction", Reliability = .)

rel_ccfe_beha_subt_subt
```

Regression of Congruency (composite effect) in d [regression of subtraction]
```{r}
rel_ccfe_beha_subt_regr <- rel_reg(rel_ccf_beha_cong_a_subt, rel_ccf_beha_cong_m_subt, 
                                   ccfe_d$cong_ali_subt, ccfe_d$cong_mis_subt) %>% 
  tibble(DV = "d", Condition = "(con_ali - inc_ali) ~ (con_mis - inc_mis)", 
         Approach = "Regression", Reliability = .)

rel_ccfe_beha_subt_regr
```

Subtraction of Congruency (composite effect) in d [subtraction of regression]
```{r}
rel_ccfe_beha_regr_subt <- rel_sub(rel_ccf_beha_cong_a_regr, rel_ccf_beha_cong_m_regr, 
                                   ccfe_d$cong_ali_regr, ccfe_d$cong_mis_regr) %>% 
  tibble(DV = "d", Condition = "(con_ali ~ inc_ali) - (con_mis ~ inc_mis)", 
         Approach = "Subtraction", Reliability = .)

rel_ccfe_beha_regr_subt
```


Regression of Congruency (composite effect) in d [regression of regression]
```{r}
rel_ccfe_beha_regr_regr <- rel_reg(rel_ccf_beha_cong_a_regr, rel_ccf_beha_cong_m_regr, 
                                   ccfe_d$cong_ali_regr, ccfe_d$cong_mis_regr) %>% 
  tibble(DV = "d", Condition = "(con_ali ~ inc_ali) ~ (con_mis ~ inc_mis)", 
         Approach = "Regression", Reliability = .)

rel_ccfe_beha_regr_regr
```

Subtraction of RT [subtraction of subtraction]
```{r}
rel_ccfe_rt_subt_subt <- rel_sub(rel_ccf_rt_cong_a_subt, rel_ccf_rt_cong_m_subt,
                            ccfe_rt$cong_ali_subt, ccfe_rt$cong_mis_subt) %>% 
  tibble(DV = "rt", Condition = "(con_ali - inc_ali) - (con_mis - inc_mis)", 
         Approach = "Subtraction", Reliability = .)

rel_ccfe_rt_subt_subt
```

Regression of RT [regression of subtraction]
```{r}
rel_ccfe_rt_subt_regr <- rel_reg(rel_ccf_rt_cong_a_subt, rel_ccf_rt_cong_m_subt,
                                 ccfe_rt$cong_ali_subt, ccfe_rt$cong_mis_subt) %>% 
  tibble(DV = "rt", Condition = "(con_ali - inc_ali) ~ (con_mis - inc_mis)", 
         Approach = "Regression", Reliability = .)

rel_ccfe_rt_subt_regr
```

Regression of RT [subtraction of regression]
```{r}
rel_ccfe_rt_regr_subt <- rel_sub(rel_ccf_rt_cong_a_regr, rel_ccf_rt_cong_m_regr,
                                 ccfe_rt$cong_ali_regr, ccfe_rt$cong_mis_regr) %>% 
  tibble(DV = "rt", Condition = "(con_ali ~ inc_ali) - (con_mis ~ inc_mis)", 
         Approach = "Subtraction", Reliability = .)

rel_ccfe_rt_regr_subt
```


Regression of RT [regression of regression]
```{r}
rel_ccfe_rt_regr_regr <- rel_reg(rel_ccf_rt_cong_a_regr, rel_ccf_rt_cong_m_regr,
                                 ccfe_rt$cong_ali_regr, ccfe_rt$cong_mis_regr) %>% 
  tibble(DV = "rt", Condition = "(con_ali ~ inc_ali) ~ (con_mis ~ inc_mis)", 
         Approach = "Regression", Reliability = .)

rel_ccfe_rt_regr_regr
```

#### Interim summary 

```{r}
bind_rows(rel_ccf_beha_ca, rel_ccf_beha_ia, rel_ccf_beha_cm, rel_ccf_beha_im, rel_ccf_beha_iso, # each condition
          rel_ccf_rt_ca, rel_ccf_rt_ia, rel_ccf_rt_cm, rel_ccf_rt_im, rel_ccf_rt_iso, # each condition
          rel_fac_beha_iso_subt, rel_fac_beha_iso_regr, rel_fac_rt_iso_subt, rel_fac_rt_iso_regr, # facilitation (isolated)
          rel_fac_beha_subt, rel_fac_beha_regr, rel_fac_rt_subt, rel_fac_rt_regr, # facilitation 
          rel_int_beha_iso_subt, rel_int_beha_iso_regr, rel_int_rt_iso_subt, rel_int_rt_iso_regr, # interference (isolated)
          rel_int_beha_subt, rel_int_beha_regr, rel_int_rt_subt, rel_int_rt_regr, # interference 
          rel_ccf_beha_cong_a_subt, rel_ccf_beha_cong_m_subt, rel_ccf_rt_cong_a_subt, rel_ccf_rt_cong_m_subt, # congruency effects (subtraction)
          rel_ccf_beha_cong_a_regr, rel_ccf_beha_cong_m_regr, rel_ccf_rt_cong_a_regr, rel_ccf_rt_cong_m_regr, # congruency effects (subtraction)
          rel_ccfe_beha_subt_subt, rel_ccfe_beha_regr_subt, rel_ccfe_beha_subt_regr, rel_ccfe_beha_regr_regr, # composite effects
          rel_ccfe_rt_subt_subt, rel_ccfe_rt_regr_subt, rel_ccfe_rt_subt_regr, rel_ccfe_rt_regr_regr # composite effects
) %>% 
  mutate(Task = "CCF", .before=1)
```


## Correlations among holistic processing effects

```{r}
# custom function to print the two-sided correlation results via library(psych)
psych_cor2 <- function(.data, ...) {
  
  # .data: data frame only includes columns for correlation (no subject code column)
  # Usage: psych_cor2(hpe_acc_subt)
  
  # run correlations
  cor_tmp <- psych::corr.test(.data, ...)
  
  cor_tmp$ci %>% 
    rename(`lower95`=lower,
           `upper95`=upper) %>% 
    mutate(N = cor_tmp$n,
           p.adj = cor_tmp$p.adj,
           adjust = cor_tmp$adjust,
           alt = "two.sided") %>% 
    bind_cols(cor_tmp$ci.adj %>% mutate(r=1) %>% select(-r)) %>% 
    return()
}
```


### Subtraction

```{r}
hpe_acc_subt <- pwe_acc %>% 
  inner_join(scfe_acc, by="Subject") %>% 
  inner_join(ccfe_d, by="Subject") %>% 
  transmute(pwe_subt, scfe_subt=-scfe_subt, ccfe_subt_subt) 

hpe_rt_subt <- pwe_rt %>% 
  inner_join(scfe_rt, by="Subject") %>% 
  inner_join(ccfe_rt, by="Subject") %>% 
  transmute(pwe_subt, scfe_subt=-scfe_subt, ccfe_subt_subt)
```

Accuracy
```{r}
corPlot(hpe_acc_subt)
```

Correlations among holistic processing effects of accuracy (subtraction)
```{r}
psych_cor2(hpe_acc_subt) %>% 
  mutate(up_bound = c(
    upper_boundary(rel_pwe_acc_subt, rel_scfe_acc_subt),
    upper_boundary(rel_pwe_acc_subt, rel_ccfe_beha_subt_subt),
    upper_boundary(rel_scfe_acc_subt, rel_ccfe_beha_subt_subt)
  ), .before = 1)
```

RT
```{r}
corPlot(hpe_rt_subt)
```

Correlations among holistic processing effects of RT (subtraction)
```{r}
psych_cor2(hpe_rt_subt) %>% 
  mutate(up_bound = c(
    upper_boundary(rel_pwe_rt_subt, rel_scfe_rt_subt),
    upper_boundary(rel_pwe_rt_subt, rel_ccfe_rt_subt_subt),
    upper_boundary(rel_scfe_rt_subt, rel_ccfe_rt_subt_subt)
  ), .before = 1)
```

### Regression

```{r}
hpe_acc_regr <- pwe_acc %>% 
  inner_join(scfe_acc, by="Subject") %>% 
  inner_join(ccfe_d, by="Subject") %>% 
  transmute(pwe_regr, scfe_regr=-scfe_regr, ccfe_subt_regr)

hpe_rt_regr <- pwe_rt %>% 
  inner_join(scfe_rt, by="Subject") %>% 
  inner_join(ccfe_rt, by="Subject") %>% 
  transmute(pwe_regr, scfe_regr=-scfe_regr, ccfe_subt_regr)
```

Accuracy
```{r}
corPlot(hpe_acc_regr)
```

Correlations among holistic processing effects of accuracy (regression)
```{r}
psych_cor2(hpe_acc_regr) %>% 
  mutate(up_bound = c(
    upper_boundary(rel_pwe_acc_regr, rel_scfe_acc_regr),
    upper_boundary(rel_pwe_acc_regr, rel_ccfe_beha_subt_regr),
    upper_boundary(rel_scfe_acc_regr, rel_ccfe_beha_subt_regr)
  ), .before = 1)
```

RT
```{r}
corPlot(hpe_rt_regr)
```

Correlations among holistic processing effects of RT (regression)
```{r}
psych_cor2(hpe_rt_regr) %>% 
  mutate(up_bound = c(
    upper_boundary(rel_pwe_rt_regr, rel_scfe_rt_regr),
    upper_boundary(rel_pwe_rt_regr, rel_ccfe_rt_subt_regr),
    upper_boundary(rel_scfe_rt_regr, rel_ccfe_rt_subt_regr)
  ), .before = 1)
```

## Correlations for facilitation and interference

```{r}
# custom function to print the two-sided correlation results via library(psych)
psych_cor1 <- function(x, y, ...) {
  
  # .data: data frame only includes columns for correlation (no subject code column)
  # Usage: psych_cor1(hpe_acc_subt)
  
  # run correlations
  cor_tmp <- psych::corr.test(x, y, alpha=.1, ...) # one-sided test
  
  rownames(cor_tmp) <- NULL
  
  cor_tmp$ci %>% 
    rename(`lower90`=lower,
           `upper90`=upper) %>% 
    mutate(N = cor_tmp$n,
           p = p/2,
           alt = "greater") %>% 
    # bind_cols(cor_tmp$ci.adj %>% mutate(r=1) %>% select(-r)) %>% 
    return()
}
```
### PW and Facilitation in CCF

#### Subtraction

accuracy 
```{r}
r_pwe_fac_acc_subt <- psych_cor1(pwe_acc$pwe_subt, ccfe_d$fac_subt) %>% 
  mutate(pair = "pwe_subt ~ fac_subt",
         DV = "acc",
         up_bound = upper_boundary(rel_pwe_acc_subt, rel_fac_beha_subt),
         .before = 1)
rownames(r_pwe_fac_acc_subt) <- NULL
r_pwe_fac_acc_subt
```

accuracy isolated
```{r}
r_pwe_fac_iso_acc_subt <- psych_cor1(pwe_acc$pwe_subt, ccfe_d$fac_subt_iso) %>% 
  mutate(pair = "pwe_subt ~ fac_subt_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_pwe_acc_subt, rel_fac_beha_iso_subt),
         .before = 1)
rownames(r_pwe_fac_iso_acc_subt) <- NULL
r_pwe_fac_iso_acc_subt
```

RT 
```{r}
r_pwe_fac_rt_subt <- psych_cor1(pwe_rt$pwe_subt, ccfe_rt$fac_subt) %>% 
  mutate(pair = "pwe_subt ~ fac_subt",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_subt, rel_fac_rt_subt),
         .before = 1)
rownames(r_pwe_fac_rt_subt) <- NULL
r_pwe_fac_rt_subt
```


RT isolated
```{r}
r_pwe_fac_iso_rt_subt <- psych_cor1(pwe_rt$pwe_subt, ccfe_rt$fac_subt_iso) %>% 
  mutate(pair = "pwe_subt ~ fac_subt_iso",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_subt, rel_fac_rt_iso_subt),
         .before = 1)
rownames(r_pwe_fac_iso_rt_subt) <- NULL
r_pwe_fac_iso_rt_subt
```

#### Regressions
Accuracy
```{r}
r_pwe_fac_acc_regr <- psych_cor1(pwe_acc$pwe_regr, ccfe_d$fac_regr) %>% 
  mutate(pair = "pwe_regr ~ fac_regr",
         DV = "acc", 
         up_bound = upper_boundary(rel_pwe_acc_regr, rel_fac_beha_regr),
         .before = 1)
rownames(r_pwe_fac_acc_regr) <- NULL
r_pwe_fac_acc_regr
```

Accuracy isolated
```{r}
r_pwe_fac_iso_acc_regr <- psych_cor1(pwe_acc$pwe_regr, ccfe_d$fac_regr_iso) %>% 
  mutate(pair = "pwe_regr ~ fac_regr_iso",
         DV = "acc", 
         up_bound = upper_boundary(rel_pwe_acc_regr, rel_fac_beha_iso_regr),
         .before = 1)
rownames(r_pwe_fac_iso_acc_regr) <- NULL
r_pwe_fac_iso_acc_regr
```

RT 
```{r}
r_pwe_fac_rt_regr <- psych_cor1(pwe_rt$pwe_regr, ccfe_rt$fac_regr) %>% 
  mutate(pair = "pwe_regr ~ fac_regr",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_regr, rel_fac_rt_regr),
         .before = 1)
rownames(r_pwe_fac_rt_regr) <- NULL
r_pwe_fac_rt_regr
```

RT isolated
```{r}
r_pwe_fac_iso_rt_regr <- psych_cor1(pwe_rt$pwe_regr, ccfe_rt$fac_regr_iso) %>% 
  mutate(pair = "pwe_regr ~ fac_regr_iso",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_regr, rel_fac_rt_iso_regr),
         .before = 1)
rownames(r_pwe_fac_iso_rt_regr) <- NULL
r_pwe_fac_iso_rt_regr
```

#### Interim summary

```{r}
r_sum_pwe_fac <- bind_rows(r_pwe_fac_acc_subt, r_pwe_fac_iso_acc_subt,
                           r_pwe_fac_rt_subt, r_pwe_fac_iso_rt_subt,
                           r_pwe_fac_acc_regr, r_pwe_fac_iso_acc_regr,
                           r_pwe_fac_rt_regr, r_pwe_fac_iso_rt_regr)

```

Corrections for the baseline of isolated:
```{r}
r_sum_pwe_fac %>% 
  filter(endsWith(pair, "_iso")) %>% 
  mutate(p_cor = p.adjust(p, method = "holm")) # apply Holm-Bonferroni
```

Corrections for the baseline of misaligned:
```{r}
r_sum_pwe_fac %>% 
  filter(!endsWith(pair, "_iso")) %>% 
  mutate(p_cor = p.adjust(p, method = "holm")) # apply Holm-Bonferroni
```

### SCF and Interference in CCF

#### Subtraction
Accuracy
```{r}
r_scfe_int_acc_subt <- psych_cor1(scfe_acc$scfe_subt, ccfe_d$int_subt) %>% 
  mutate(pair = "scfe_subt ~ int_subt",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_subt, rel_int_beha_subt),
         .before = 1)
rownames(r_scfe_int_acc_subt) <- NULL
r_scfe_int_acc_subt
```

Accuracy isolated
```{r}
r_scfe_int_iso_acc_subt <- psych_cor1(scfe_acc$scfe_subt, ccfe_d$int_subt_iso) %>% 
  mutate(pair = "scfe_subt ~ int_subt_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_subt, rel_int_beha_iso_subt),
         .before = 1)
rownames(r_scfe_int_iso_acc_subt) <- NULL
r_scfe_int_iso_acc_subt
```

RT 
```{r}
r_scfe_int_rt_subt <- psych_cor1(scfe_rt$scfe_subt, ccfe_rt$int_subt) %>% 
  mutate(pair = "scfe_subt ~ int_subt",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_subt, rel_int_rt_subt),
         .before = 1)
rownames(r_scfe_int_rt_subt) <- NULL
r_scfe_int_rt_subt
```

RT isolated
```{r}
r_scfe_int_iso_rt_subt <- psych_cor1(scfe_rt$scfe_subt, ccfe_rt$int_subt_iso) %>% 
  mutate(pair = "scfe_subt ~ int_subt_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_rt_subt, rel_int_rt_iso_subt),
         .before = 1)
rownames(r_scfe_int_iso_rt_subt) <- NULL
r_scfe_int_iso_rt_subt
```

#### Regressions
Accuracy
```{r}
r_scfe_int_acc_regr <- psych_cor1(scfe_acc$scfe_regr, ccfe_d$int_regr) %>% 
  mutate(pair = "scfe_regr ~ int_regr",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_regr, rel_int_beha_regr),
         .before = 1)
rownames(r_scfe_int_acc_regr) <- NULL
r_scfe_int_acc_regr
```

Accuracy isolated
```{r}
r_scfe_int_iso_acc_regr <- psych_cor1(scfe_acc$scfe_regr, ccfe_d$int_regr_iso) %>% 
  mutate(pair = "scfe_regr ~ int_regr_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_regr, rel_int_beha_iso_regr),
         .before = 1)
rownames(r_scfe_int_iso_acc_regr) <- NULL
r_scfe_int_iso_acc_regr
```

RT
```{r}
r_scfe_int_rt_regr <- psych_cor1(scfe_rt$scfe_regr, ccfe_rt$int_regr) %>% 
  mutate(pair = "scfe_regr ~ int_regr",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_regr, rel_int_rt_regr),
         .before = 1)
rownames(r_scfe_int_rt_regr) <- NULL
r_scfe_int_rt_regr
```

RT isolated
```{r}
r_scfe_int_iso_rt_regr <- psych_cor1(scfe_rt$scfe_regr, ccfe_rt$int_regr_iso) %>% 
  mutate(pair = "scfe_regr ~ int_regr_iso",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_regr, rel_int_rt_iso_regr),
         .before = 1)
rownames(r_scfe_int_iso_rt_regr) <- NULL
r_scfe_int_iso_rt_regr
```

#### Interim summary

```{r}
r_sum_scfe_int <- bind_rows(r_scfe_int_acc_subt, r_scfe_int_iso_acc_subt,
                            r_scfe_int_rt_subt, r_scfe_int_iso_rt_subt,
                            r_scfe_int_acc_regr, r_scfe_int_iso_acc_regr,
                            r_scfe_int_rt_regr, r_scfe_int_iso_rt_regr) 
```

Corrections for the baseline of isolated:
```{r}
r_sum_scfe_int %>% 
  filter(endsWith(pair, "_iso")) %>% 
  mutate(p_cor = p.adjust(p, method = "holm")) # apply Holm-Bonferroni
```

Corrections for the baseline of isolated:
```{r}
r_sum_scfe_int %>% 
  filter(!endsWith(pair, "_iso")) %>% 
  mutate(p_cor = p.adjust(p, method = "holm")) # apply Holm-Bonferroni
```

## Pairwise correlations (exploratory)

### Behavioral choices

```{r fig.width=7, fig.asp=1}
pwe_acc %>% 
  inner_join(scfe_acc, by="Subject") %>% 
  inner_join(ccfe_d, by="Subject") %>% 
  select(-Subject, -contains("regr")) %>% 
  cor.plot()
```

```{r fig.width=7, fig.asp=1}
pwe_acc %>% 
  inner_join(scfe_acc, by="Subject") %>% 
  inner_join(ccfe_d, by="Subject") %>% 
  select(-Subject, -contains("subt"), ccfe_subt_regr) %>% 
  cor.plot()
```

### Response times

```{r}
pwe_rt %>% 
  left_join(scfe_rt, by="Subject") %>% 
  left_join(ccfe_rt, by="Subject") %>% 
  select(-Subject, -contains("regr")) %>% 
  cor.plot()
```

```{r}
pwe_rt %>% 
  left_join(scfe_rt, by="Subject") %>% 
  left_join(ccfe_rt, by="Subject") %>% 
  select(-Subject, -contains("subt"), ccfe_subt_regr) %>% 
  cor.plot()
```

