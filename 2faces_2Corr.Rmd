
# Relationships among effects

## Calculate holistic processing effects

```{r}
# custom function to use linear models to apply the regression method
cal_reg <- function(.data, formula, outvar){
  
  # .data: the input dataframe
  # formula: used in lm()
  # outvar: the column name for the regression effect (residuals) [new column]
  
  # perform linear regression
  lm_tmp <- lm(formula, .data)
  
  # save the residuals
  return(mutate(.data, {{outvar}} := residuals(lm_tmp))) # outvar is a variable
  # return(mutate(.data, "{outvar}" := residuals(lm_tmp))) # outvar is a string
}
```


### Part-whole task

Condition means and part-whole effect in accuracy:
```{r}
pwe_acc <- df_pw %>% 
  group_by(Subject, PW) %>% 
  summarize(acc = mean(Correct),
            .groups = "drop") %>% 
  pivot_wider(id_cols=Subject, names_from = PW, values_from = acc) %>% 
  mutate(pwe_subt = whole - part) %>% # subtraction
  cal_reg(whole ~ part, pwe_regr) # regression

pwe_acc
```

Condition means and part-whole effect in RT:
```{r}
pwe_rt <- df_pw %>% 
  filter(Correct) %>% 
  group_by(Subject, PW) %>% 
  summarize(rt = mean(RT),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = PW, values_from = rt) %>% 
  mutate(pwe_subt = whole - part) %>% # subtraction
  cal_reg(whole ~ part, pwe_regr) # regression

pwe_rt
```

### Standard composite face task
Condition means and composite effect in accuracy:
```{r}
scfe_acc <- df_scf %>% 
  group_by(Subject, Alignment) %>% 
  summarize(acc = mean(Correct),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = Alignment, values_from = acc) %>% 
  mutate(scfe_subt = ali - mis) %>% # subtraction
  cal_reg(ali ~ mis, scfe_regr) # regression

scfe_acc
```

Condition means and composite effect in RT:
```{r}
scfe_rt <- df_scf %>% 
  filter(Correct) %>% 
  group_by(Subject, Alignment) %>% 
  summarize(rt = mean(RT),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = Alignment, values_from = rt) %>% 
  mutate(scfe_subt = ali - mis) %>% # subtraction
  cal_reg(ali ~ mis, scfe_regr) # regression

scfe_rt
```

### Complete composite face task
Condition means and composite effect in sensitivity d':
```{r}
ccfe_d <- df_ccf_iso %>% 
  group_by(Subject, Congruency, Alignment, SD) %>% 
  summarize(count = n(),
            same_adjust = (sum(isSame)+0.5)/(count+1), # Snodgrass & Corwin (1988)
            .groups = "drop") %>% 
  mutate(z = qnorm(same_adjust)) %>% 
  select(-c(same_adjust, count)) %>% 
  pivot_wider(names_from = "SD", values_from = z) %>% 
  mutate(d = same - diff) %>% 
  pivot_wider(Subject, names_from = c(Congruency, Alignment), values_from = d) %>% 
  rename(isolated = iso_iso) %>% 
  mutate(fac_subt = con_ali - con_mis, # subtraction
         int_subt = inc_ali - inc_mis, # subtraction
         fac_subt_iso = con_ali - isolated, # subtraction
         int_subt_iso = inc_ali - isolated, # subtraction
         cong_ali_subt = con_ali - inc_ali, # subtraction
         cong_mis_subt = con_mis - inc_mis, # subtraction
         ccfe_subt_subt = cong_ali_subt - cong_mis_subt) %>%  # subtraction
  cal_reg(con_ali ~ con_mis, fac_regr) %>% # regression
  cal_reg(inc_ali ~ inc_mis, int_regr) %>% # regression
  cal_reg(con_ali ~ isolated, fac_regr_iso) %>% # regression
  cal_reg(inc_ali ~ isolated, int_regr_iso) %>% # regression
  cal_reg(con_ali ~ inc_ali, cong_ali_regr) %>% # regression
  cal_reg(con_mis ~ inc_mis, cong_mis_regr) %>% # regression
  cal_reg(cong_ali_subt ~ cong_mis_subt, ccfe_subt_regr) %>% # regression
  cal_reg(cong_ali_regr ~ cong_mis_regr, ccfe_regr_regr) # regression

ccfe_d 
```

Condition means and composite effect in RT:
```{r}
ccfe_rt <- df_ccf_iso %>% 
  filter(Correct) %>% 
  group_by(Subject, Congruency, Alignment) %>% 
  summarize(rt = mean(RT),
            .groups = "drop") %>% 
  pivot_wider(Subject, names_from = c(Congruency, Alignment), values_from = rt) %>% 
  rename(isolated = iso_iso) %>% 
  mutate(fac_subt = con_ali - con_mis, # subtraction
         int_subt = inc_ali - inc_mis, # subtraction
         fac_subt_iso = con_ali - isolated, # subtraction
         int_subt_iso = inc_ali - isolated, # subtraction
         cong_ali_subt = con_ali - inc_ali, # subtraction
         cong_mis_subt = con_mis - inc_mis, # subtraction
         ccfe_subt_subt = cong_ali_subt - cong_mis_subt) %>% # subtraction
  cal_reg(con_ali ~ con_mis, fac_regr) %>% # regression
  cal_reg(inc_ali ~ inc_mis, int_regr) %>% # regression
  cal_reg(con_ali ~ isolated, fac_regr_iso) %>% # regression
  cal_reg(inc_ali ~ isolated, int_regr_iso) %>% # regression
  cal_reg(con_ali ~ inc_ali, cong_ali_regr) %>% # regression
  cal_reg(con_mis ~ inc_mis, cong_mis_regr) %>% # regression
  cal_reg(cong_ali_subt ~ cong_mis_subt, ccfe_subt_regr) %>% # regression [first step is subtraction; second step is regression]
  cal_reg(cong_ali_regr ~ cong_mis_regr, ccfe_regr_regr) # regression

ccfe_rt
```

### Holistic effects
```{r}
# put all effects in one data frame
hpe_acc <- pwe_acc %>% 
  inner_join(scfe_acc, by="Subject") %>% 
  inner_join(ccfe_d, by="Subject") %>% 
  # make it to larger values corresponding to stronger composite effect
  mutate(scfe_subt = -scfe_subt, 
         scfe_regr = -scfe_regr, 
         int_subt = -int_subt,
         int_subt_iso = -int_subt_iso,
         int_regr = -int_regr,
         int_regr_iso = -int_regr_iso)

hpe_rt <- pwe_rt %>% 
  left_join(scfe_rt, by="Subject") %>% 
  left_join(ccfe_rt, by="Subject") %>% 
  # make it to larger values corresponding to stronger composite effect
  mutate(scfe_subt = -scfe_subt, 
         scfe_regr = -scfe_regr,
         int_subt = -int_subt,
         int_subt_iso = -int_subt_iso,
         int_regr = -int_regr,
         int_regr_iso = -int_regr_iso)
```

## Reliability of measurement

`psych::splitHalf(..., check.keys=FALSE)` is used to calculate the Guttman's $\lambda_2$ (although it will report results of various methods). 

```{r}
# a general (custom) function to calculate the reliability for each condition
rel_each <- function(.data, DV, ...){
  
  out <- 
    .data %>%
    filter(...) %>% # to filter out conditions
    pivot_wider(Subject, values_from = all_of(DV), names_from = test_item) %>%
    select(-Subject) %>%
    data.matrix() %>% 
    splitHalf(check.keys=FALSE)
  
  return(out$lambda2) # only output lambda2
}
```

```{r}
# function to calculate the reliability of subtraction scores
rel_sub <- function(re_inte, re_base, raw_inte, raw_base){
  
  # re_inte: the reliability of the condition of interest
  # re_base: the reliability of the baseline condition
  # raw_inte: the raw values for each participant in the condition of interest
  # raw_base: the raw values for each participant in the baseline condition
  
  tmp <- 2*sd(raw_inte)*sd(raw_base)*cor(raw_inte, raw_base)
  
  top <- var(raw_inte) * re_inte$Reliability + var(raw_base) * re_base$Reliability - tmp
  bot <- var(raw_inte) + var(raw_base) - tmp
  
  return(top/bot)
}

```

```{r}
# function to calculate the reliability of regression scores
rel_reg <- function(re_inte, re_base, raw_inte, raw_base){
  
  # re_inte: the reliability of the condition of interest
  # re_base: the reliability of the baseline condition
  # raw_inte: the raw values for each participant in the condition of interest
  # raw_base: the raw values for each participant in the baseline condition
  
  tmp1 <- cor(raw_inte, raw_base)^2
  
  top <- re_inte$Reliability + re_base$Reliability * tmp1 - 2 * tmp1
  bot <- 1 - tmp1
  
  return(top/bot)
}

```

```{r}
# function to calculate the upper boundary of the correlation
upper_boundary <- function(re1, re2){
  # reliability will be set to 0 if it is negative
  return(sqrt(max(re1$Reliability,0) * max(re2$Reliability,0)))
}
```

### Part-whole task
Structure of part-whole task data for calculating reliability:
```{r}
# PW
df_pw_rel <- df_pw %>%
  mutate(test_item = paste(str_remove(basename(StudyFace), ".png"), 
                           str_remove(basename(TestFace), ".png"), sep="_"))
str(df_pw_rel)
```

#### Reliability of each condition

Accuracy for whole
```{r}
rel_pw_acc_w <- rel_each(df_pw_rel, "Correct", PW=="whole") %>%  
  tibble(DV = "acc", Condition = "whole", Approach = "GuttmanL2",  Reliability = .)
rel_pw_acc_w
```

Accuracy for part
```{r}
rel_pw_acc_p <- rel_each(df_pw_rel, "Correct", PW=="part") %>% 
  tibble(DV = "acc", Condition = "part", Approach = "GuttmanL2", Reliability = .)
rel_pw_acc_p
```

RT for whole
```{r}
rel_pw_rt_w <- rel_each(df_pw_rel, "RT", PW=="whole") %>% 
  tibble(DV = "rt", Condition = "whole", Approach = "GuttmanL2", Reliability = .)
rel_pw_rt_w
```

RT for part
```{r}
rel_pw_rt_p <- rel_each(df_pw_rel, "RT", PW=="part") %>% 
  tibble(DV = "rt", Condition = "part", Approach = "GuttmanL2", Reliability = .)
rel_pw_rt_p
```

#### Reliability of the part-whole effect

Subtraction of accuracy
```{r}
rel_pwe_acc_subt <- rel_sub(rel_pw_acc_w, rel_pw_acc_p,
                            pwe_acc$whole, pwe_acc$part) %>% 
  tibble(DV = "acc", Condition = "whole - part", 
         Approach = "Subtraction", Reliability = .)
rel_pwe_acc_subt
```

Regression of accuracy
```{r}
rel_pwe_acc_regr <- rel_reg(rel_pw_acc_w, rel_pw_acc_p,
                            pwe_acc$whole, pwe_acc$part) %>% 
  tibble(DV = "acc", Condition = "whole ~ part", 
         Approach = "Regression", Reliability = .)
rel_pwe_acc_regr
```

Subtraction of RT
```{r}
rel_pwe_rt_subt <- rel_sub(rel_pw_rt_w, rel_pw_rt_p,
                           pwe_rt$whole, pwe_rt$part) %>% 
  tibble(DV = "rt", Condition = "whole - part", 
         Approach = "Subtraction", Reliability = .)
rel_pwe_rt_subt
```

Regression of RT
```{r}
rel_pwe_rt_regr <- rel_reg(rel_pw_rt_w, rel_pw_rt_p,
                           pwe_rt$whole, pwe_rt$part) %>% 
  tibble(DV = "rt", Condition = "whole ~ part", 
         Approach = "Regression", Reliability = .)
rel_pwe_rt_regr
```

#### Interim summary 

```{r}
rel_sum_pw <- bind_rows(rel_pw_acc_w, rel_pw_acc_p, rel_pw_rt_w, rel_pw_rt_p,
                        rel_pwe_acc_subt, rel_pwe_acc_regr, rel_pwe_rt_subt, rel_pwe_rt_regr) %>% 
  mutate(Task="PW", .before=1)
rel_sum_pw
```

### Standard composite face task
Structure of standard composite face task data for calculating reliability:
```{r}  
# SCF
df_scf_rel <- df_scf %>% 
  group_by(Subject, Alignment) %>% 
  summarize(test_item = 1:n(),
            Correct, RT,
            .groups = "drop") 

str(df_scf_rel)
```

#### Reliability of each condition
Accuracy for aligned
```{r}
rel_scf_acc_a <- rel_each(df_scf_rel, "Correct", Alignment=="ali") %>% 
  tibble(DV = "acc", Condition = "aligned", Approach = "GuttmanL2",  Reliability = .)
rel_scf_acc_a
```

Accuracy for misaligned
```{r}
rel_scf_acc_m <- rel_each(df_scf_rel, "Correct", Alignment=="mis") %>% 
  tibble(DV = "acc", Condition = "misaligned", Approach = "GuttmanL2",  Reliability = .)
rel_scf_acc_m
```

RT for aligned
```{r}
rel_scf_rt_a <- rel_each(df_scf_rel, "RT", Alignment=="ali") %>% 
  tibble(DV = "rt", Condition = "aligned", Approach = "GuttmanL2",  Reliability = .)
rel_scf_rt_a
```

RT for misaligned
```{r}
rel_scf_rt_m <- rel_each(df_scf_rel, "RT", Alignment=="mis") %>% 
  tibble(DV = "rt", Condition = "misaligned", Approach = "GuttmanL2",  Reliability = .)
rel_scf_rt_m
```

#### Reliability of the composite effect

Subtraction of accuracy
```{r}
rel_scfe_acc_subt <- rel_sub(rel_scf_acc_a, rel_scf_acc_m, 
                             scfe_acc$ali, scfe_acc$mis) %>% 
  tibble(DV = "acc", Condition = "ali - mis", 
         Approach = "Subtraction", Reliability = .)
rel_scfe_acc_subt
```

Regression of accuracy
```{r}
rel_scfe_acc_regr <- rel_reg(rel_scf_acc_a, rel_scf_acc_m, 
                             scfe_acc$ali, scfe_acc$mis) %>% 
  tibble(DV = "acc", Condition = "ali ~ mis", 
         Approach = "Regression", Reliability = .)
rel_scfe_acc_regr
```

Subtraction of RT
```{r}
rel_scfe_rt_subt <- rel_sub(rel_scf_rt_a, rel_scf_rt_m, 
                            scfe_rt$ali, scfe_rt$mis) %>% 
  tibble(DV = "rt", Condition = "ali - mis", 
         Approach = "Subtraction", Reliability = .)
rel_scfe_rt_subt
```

Regression of RT
```{r}
rel_scfe_rt_regr <- rel_reg(rel_scf_rt_a, rel_scf_rt_m, 
                            scfe_rt$ali, scfe_rt$mis) %>% 
  tibble(DV = "rt", Condition = "ali ~ mis", 
         Approach = "Regression", Reliability = .)
rel_scfe_rt_regr
```

#### Interim summary 

```{r}
rel_sum_scf <- bind_rows(rel_scf_acc_a, rel_scf_acc_m, rel_scf_rt_a, rel_scf_rt_m,
                         rel_scfe_acc_subt, rel_scfe_acc_regr, rel_scfe_rt_subt, rel_scfe_rt_regr) %>% 
  mutate(Task = "SCF", .before =1)
rel_sum_scf
```

### Complete composite face task
Structure of complete composite face task data for calculating reliability:
```{r}
# CCF
df_ccf_rel <- df_ccf_iso %>% # need to include the isolated condition
  group_by(Subject, Congruency, Alignment) %>% 
  summarize(test_item = 1:n(),
            Correct, RT,
            .groups = "drop") 

str(df_ccf_rel)
```

#### Reliability of each condition (acc & RT)

Behavioral choices for congruent aligned
```{r}
rel_ccf_beha_ca <- rel_each(df_ccf_rel, "Correct", 
                            Congruency=="con", Alignment=="ali") %>%
  tibble(DV = "acc", Condition = "con_ali", 
         Approach = "GuttmanL2",  Reliability = .)

rel_ccf_beha_ca
```

Behavioral choices for incongruent aligned
```{r}
rel_ccf_beha_ia <- rel_each(df_ccf_rel, "Correct", 
                            Congruency=="inc", Alignment=="ali") %>% 
  tibble(DV = "acc", Condition = "inc_ali", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_ia
```

Behavioral choices for congruent misaligned
```{r}
rel_ccf_beha_cm <- rel_each(df_ccf_rel, "Correct", 
                            Congruency=="con", Alignment=="mis") %>%
  tibble(DV = "acc", Condition = "con_mis", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_cm
```

Behavioral choices for incongruent misaligned
```{r}
rel_ccf_beha_im <- rel_each(df_ccf_rel, "Correct", 
                            Congruency=="inc", Alignment=="mis") %>% 
  tibble(DV = "acc", Condition = "inc_mis", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_im
```

Behavioral choices for isolated
```{r}
rel_ccf_beha_iso <- rel_each(df_ccf_rel, "Correct", 
                             Congruency=="iso", Alignment=="iso") %>%
  tibble(DV = "acc", Condition = "isolated", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_beha_iso
```

RT for congruent aligned
```{r}
rel_ccf_rt_ca <- rel_each(df_ccf_rel, "RT", 
                          Congruency=="con", Alignment=="ali") %>% 
  tibble(DV = "rt", Condition = "con_ali", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_ca
```

RT for incongruent aligned
```{r}
rel_ccf_rt_ia <- rel_each(df_ccf_rel, "RT", 
                          Congruency=="inc", Alignment=="ali") %>% 
  tibble(DV = "rt", Condition = "inc_ali", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_ia
```

RT for congruent misaligned
```{r}
rel_ccf_rt_cm <- rel_each(df_ccf_rel, "RT", 
                          Congruency=="con", Alignment=="mis") %>% 
  tibble(DV = "rt", Condition = "con_mis", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_cm
```

RT for incongruent misaligned
```{r}
rel_ccf_rt_im <- rel_each(df_ccf_rel, "RT", 
                          Congruency=="inc", Alignment=="mis") %>% 
  tibble(DV = "rt", Condition = "inc_mis", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_im
```

RT for isolated
```{r}
rel_ccf_rt_iso <- rel_each(df_ccf_rel, "RT", 
                           Congruency=="iso", Alignment=="iso") %>% 
  tibble(DV = "rt", Condition = "isolated", 
         Approach = "GuttmanL2",  Reliability = .)
rel_ccf_rt_iso
```

#### Reliability of each condition (d')

```{r}
rel_each_d <- function(.data, iter=100, startseed=12, cores=4){
  
  seeds <- startseed+1:iter
  ls_df <- pbapply::pblapply(seeds, rel_each_d_one, cl=cores,
                             df_each=.data)
  df_rel_d <- bind_rows(ls_df, .id = "iter") %>% 
    summarize(Reliability = mean(lambda2)) %>% 
    mutate(DV = "d",
           Approach = "GuttmanL2",
           .before=1) %>% 
    mutate(niter=iter)
  
  return(df_rel_d)
}

# calculate d' for one random split
rel_each_d_one <- function(df_each, seed){
  set.seed(seed)
  
  rel_value <- df_each %>% 
    # split data into two half
    group_by(Subject, Cue, SD) %>% 
    summarize(isSame,
              half = paste0("h", 2-(sample(n(), n())>n()/2)),
              .groups = "drop") %>% 
    # calculate d'
    group_by(Subject, SD, half) %>% 
    summarize(saysame = sum(isSame),
              count = n(),
              .groups = "drop") %>% 
    mutate(saysame = (saysame+.5)/(count+1), # correction
           saysame = qnorm(saysame)) %>% 
    select(-count) %>% 
    pivot_wider(names_from = SD, values_from = saysame) %>% 
    mutate(d = same - diff) %>% 
    select(-c(same, diff)) %>% 
    pivot_wider(names_from = half, values_from = d) %>% 
    select(-Subject) %>% 
    psych::splitHalf(check.keys=FALSE)
  
  return(data.frame(lambda2 = rel_value$lambda2))
}

# parameters for calculating d'
niter <- 10000
ncore <- 16
```

d' for congruent aligned
```{r}
thisfile <- file.path("simulation", "rel_ccf_d_ca.rds")

if (file.exists(thisfile)) {
  
  rel_ccf_d_ca <- readRDS(thisfile)
  
} else {
  rel_ccf_d_ca <- df_ccf_iso %>% 
    filter(Congruency=="con", Alignment=="ali") %>%
    rel_each_d(iter = niter, cores = ncore) %>% 
    mutate(Condition = "con_ali")
  
  saveRDS(rel_ccf_d_ca, thisfile)
}

rel_ccf_d_ca
```


d' for incongruent aligned
```{r}
thisfile <- file.path("simulation", "rel_ccf_d_ia.rds")

if (file.exists(thisfile)) {
  
  rel_ccf_d_ia <- readRDS(thisfile)
  
} else {
  rel_ccf_d_ia <- df_ccf_iso %>% 
    filter(Congruency=="inc", Alignment=="ali") %>%
    rel_each_d(iter = niter, cores = ncore) %>% 
    mutate(Condition = "inc_ali")
  
  saveRDS(rel_ccf_d_ia, thisfile)
}

rel_ccf_d_ia
```

d' for congruent misaligned
```{r}
thisfile <- file.path("simulation", "rel_ccf_d_cm.rds")

if (file.exists(thisfile)) {
  
  rel_ccf_d_cm <- readRDS(thisfile)
  
} else {
  rel_ccf_d_cm <- df_ccf_iso %>% 
    filter(Congruency=="con", Alignment=="mis") %>%
    rel_each_d(iter = niter, cores = ncore) %>% 
    mutate(Condition = "con_mis")
  
  saveRDS(rel_ccf_d_cm, thisfile)
}

rel_ccf_d_cm
```

d' for incongruent misaligned
```{r}
thisfile <- file.path("simulation", "rel_ccf_d_im.rds")

if (file.exists(thisfile)) {
  
  rel_ccf_d_im <- readRDS(thisfile)
  
} else {
  rel_ccf_d_im <- df_ccf_iso %>% 
    filter(Congruency=="inc", Alignment=="mis") %>%
    rel_each_d(iter = niter, cores = ncore) %>% 
    mutate(Condition="inc_mis")
  
  saveRDS(rel_ccf_d_im, thisfile)
}

rel_ccf_d_im
```

d' for isolated
```{r}
thisfile <- file.path("simulation", "rel_ccf_d_iso.rds")

if (file.exists(thisfile)) {
  
  rel_ccf_d_iso <- readRDS(thisfile)
  
} else {
  rel_ccf_d_iso <- df_ccf_iso %>% 
    filter(Congruency=="iso", Alignment=="iso") %>%
    rel_each_d(iter = niter, cores = ncore) %>% 
    mutate(Condition="isolated")
  
  saveRDS(rel_ccf_d_iso, thisfile)
}

rel_ccf_d_iso
```

#### Reliability of facilitation

Subtraction of accuracy (with isolated baselines)
```{r}
rel_fac_d_iso_subt <- rel_sub(rel_ccf_d_ca, rel_ccf_d_iso, 
                              ccfe_d$con_ali, ccfe_d$isolated) %>% 
  tibble(DV = "d", Condition = "con_ali - isolated", 
         Approach = "Subtraction",  Reliability = .)

rel_fac_d_iso_subt
```

Regression of accuracy (with isolated baselines)
```{r}
rel_fac_d_iso_regr <- rel_reg(rel_ccf_d_ca, rel_ccf_d_iso, 
                              ccfe_d$con_ali, ccfe_d$isolated) %>% 
  tibble(DV = "d", Condition = "con_ali ~ isolated", 
         Approach = "Regression",  Reliability = .)

rel_fac_d_iso_regr
```

Subtraction of RT (with isolated baselines)
```{r}
rel_fac_rt_iso_subt <- rel_sub(rel_ccf_rt_ca, rel_ccf_rt_iso, 
                               ccfe_rt$con_ali, ccfe_rt$isolated) %>% 
  tibble(DV = "rt", Condition = "con_ali - isolated", 
         Approach = "Subtraction",  Reliability = .)

rel_fac_rt_iso_subt
```

Regression of RT (with isolated baselines)
```{r}
rel_fac_rt_iso_regr <- rel_reg(rel_ccf_rt_ca, rel_ccf_rt_iso, 
                               ccfe_rt$con_ali, ccfe_rt$isolated) %>% 
  tibble(DV = "rt", Condition = "con_ali ~ isolated", 
         Approach = "Regression",  Reliability = .)

rel_fac_rt_iso_regr
```

Subtraction of accuracy (with misaligned baselines)
```{r}
rel_fac_d_subt <- rel_sub(rel_ccf_d_ca, rel_ccf_d_cm, 
                          ccfe_d$con_ali, ccfe_d$con_mis) %>% 
  tibble(DV = "d", Condition = "con_ali - con_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_fac_d_subt
```

Regression of accuracy (with misaligned baselines)
```{r}
rel_fac_d_regr <- rel_reg(rel_ccf_d_ca, rel_ccf_d_cm, 
                          ccfe_d$con_ali, ccfe_d$con_mis) %>% 
  tibble(DV = "d", Condition = "con_ali ~ con_mis", 
         Approach = "Regression",  Reliability = .)

rel_fac_d_regr
```

Subtraction of RT (with misaligned baselines)
```{r}
rel_fac_rt_subt <- rel_sub(rel_ccf_rt_ca, rel_ccf_rt_cm, 
                           ccfe_rt$con_ali, ccfe_rt$con_mis) %>% 
  tibble(DV = "rt", Condition = "con_ali - con_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_fac_rt_subt
```

Regression of RT (with misaligned baselines)
```{r}
rel_fac_rt_regr <- rel_reg(rel_ccf_rt_ca, rel_ccf_rt_cm, 
                           ccfe_rt$con_ali, ccfe_rt$con_mis) %>% 
  tibble(DV = "rt", Condition = "con_ali ~ con_mis", 
         Approach = "Regression",  Reliability = .)

rel_fac_rt_subt
```


#### Reliability of interference

Subtraction of d (with isolated baselines)
```{r}
rel_int_d_iso_subt <- rel_sub(rel_ccf_d_ia, rel_ccf_d_iso, 
                              ccfe_d$inc_ali, ccfe_d$isolated) %>% 
  tibble(DV = "d", Condition = "inc_ali - isolated", 
         Approach = "Subtraction",  Reliability = .)

rel_int_d_iso_subt
```

Regression of d (with isolated baselines)
```{r}
rel_int_d_iso_regr <- rel_reg(rel_ccf_d_ia, rel_ccf_d_iso,
                              ccfe_d$inc_ali, ccfe_d$isolated) %>% 
  tibble(DV = "d", Condition = "inc_ali ~ isolated", 
         Approach = "Regression",  Reliability = .)

rel_int_d_iso_regr
```

Subtraction of RT (with isolated baselines)
```{r}
rel_int_rt_iso_subt <- rel_sub(rel_ccf_rt_ia, rel_ccf_rt_iso, 
                               ccfe_rt$inc_ali, ccfe_rt$isolated) %>% 
  tibble(DV = "rt", Condition = "inc_ali - isolated", 
         Approach = "Subtraction",  Reliability = .)

rel_int_rt_iso_subt
```

Regression of RT (with isolated baselines)
```{r}
rel_int_rt_iso_regr <- rel_reg(rel_ccf_rt_ia, rel_ccf_rt_iso, 
                               ccfe_rt$inc_ali, ccfe_rt$isolated) %>% 
  tibble(DV = "rt", Condition = "inc_ali ~ isolated", 
         Approach = "Regression",  Reliability = .)

rel_int_rt_iso_regr
```

Subtraction of d (with misaligned baselines)
```{r}
rel_int_d_subt <- rel_sub(rel_ccf_d_ia, rel_ccf_d_im, 
                          ccfe_d$inc_ali, ccfe_d$inc_mis) %>% 
  tibble(DV = "d", Condition = "inc_ali - inc_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_int_d_subt
```

Regression of d (with misaligned baselines)
```{r}
rel_int_d_regr <- rel_reg(rel_ccf_d_ia, rel_ccf_d_im,
                          ccfe_d$inc_ali, ccfe_d$inc_mis) %>% 
  tibble(DV = "d", Condition = "inc_ali ~ inc_mis", 
         Approach = "Regression",  Reliability = .)

rel_int_d_regr
```

Subtraction of RT (with misaligned baselines)
```{r}
rel_int_rt_subt <- rel_sub(rel_ccf_rt_ia, rel_ccf_rt_im, 
                           ccfe_rt$inc_ali, ccfe_rt$inc_mis) %>% 
  tibble(DV = "rt", Condition = "inc_ali - inc_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_int_rt_subt
```

Regression of RT (with misaligned baselines)
```{r}
rel_int_rt_regr <- rel_reg(rel_ccf_rt_ia, rel_ccf_rt_im, 
                           ccfe_rt$inc_ali, ccfe_rt$inc_mis) %>% 
  tibble(DV = "rt", Condition = "inc_ali ~ inc_mis", 
         Approach = "Regression",  Reliability = .)

rel_int_rt_regr
```


#### Reliability of congruency effects

Congruency in d subtraction (aligned)
```{r}
rel_ccf_d_cong_a_subt <- rel_sub(rel_ccf_d_ca, rel_ccf_d_ia, 
                                 ccfe_d$con_ali, ccfe_d$inc_ali) %>% 
  tibble(DV = "d", Condition = "con_ali - inc_ali", 
         Approach = "Subtraction",  Reliability = .)

rel_ccf_d_cong_a_subt
```

Congruency in d regression (aligned)
```{r}
rel_ccf_d_cong_a_regr <- rel_reg(rel_ccf_d_ca, rel_ccf_d_ia, 
                                 ccfe_d$con_ali, ccfe_d$inc_ali) %>% 
  tibble(DV = "d", Condition = "con_ali ~ inc_ali", 
         Approach = "Regression",  Reliability = .)

rel_ccf_d_cong_a_regr
```

Congruency in d subtraction (misaligned)
```{r}
rel_ccf_d_cong_m_subt <- rel_sub(rel_ccf_d_cm, rel_ccf_d_im, 
                                 ccfe_d$con_mis, ccfe_d$inc_mis) %>% 
  tibble(DV = "d", Condition = "con_mis - inc_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_ccf_d_cong_m_subt
```

Congruency in d regression (misaligned)
```{r}
rel_ccf_d_cong_m_regr <- rel_reg(rel_ccf_d_cm, rel_ccf_d_im, 
                                 ccfe_d$con_mis, ccfe_d$inc_mis) %>% 
  tibble(DV = "d", Condition = "con_mis ~ inc_mis", 
         Approach = "Regression",  Reliability = .)

rel_ccf_d_cong_m_regr
```

Congruency in RT subtraction (aligned)
```{r}
rel_ccf_rt_cong_a_subt <- rel_sub(rel_ccf_rt_ca, rel_ccf_rt_ia, 
                                  ccfe_rt$con_ali, ccfe_rt$inc_ali) %>% 
  tibble(DV = "rt", Condition = "con_ali - inc_ali", 
         Approach = "Subtraction",  Reliability = .)

rel_ccf_rt_cong_a_subt
```

Congruency in RT regression (aligned)
```{r}
rel_ccf_rt_cong_a_regr <- rel_reg(rel_ccf_rt_ca, rel_ccf_rt_ia, 
                                  ccfe_rt$con_ali, ccfe_rt$inc_ali) %>% 
  tibble(DV = "rt", Condition = "con_ali ~ inc_ali", 
         Approach = "Regression",  Reliability = .)

rel_ccf_rt_cong_a_regr
```

Congruency in RT subtraction (misaligned)
```{r}
rel_ccf_rt_cong_m_subt <- rel_sub(rel_ccf_rt_cm, rel_ccf_rt_im, 
                                  ccfe_rt$con_mis, ccfe_rt$inc_mis) %>% 
  tibble(DV = "rt", Condition = "con_mis - inc_mis", 
         Approach = "Subtraction",  Reliability = .)

rel_ccf_rt_cong_m_subt
```

Congruency in RT subtraction (misaligned)
```{r}
rel_ccf_rt_cong_m_regr <- rel_reg(rel_ccf_rt_cm, rel_ccf_rt_im, 
                                  ccfe_rt$con_mis, ccfe_rt$inc_mis) %>% 
  tibble(DV = "rt", Condition = "con_mis ~ inc_mis", 
         Approach = "Regression",  Reliability = .)

rel_ccf_rt_cong_m_regr
```

#### Reliability of the composite effect

Subtraction of Congruency (composite effect) in d [subtraction of subtraction]
```{r}
rel_ccfe_d_subt_subt <- rel_sub(rel_ccf_d_cong_a_subt, rel_ccf_d_cong_m_subt, 
                                ccfe_d$cong_ali_subt, ccfe_d$cong_mis_subt) %>% 
  tibble(DV = "d", Condition = "(con_ali - inc_ali) - (con_mis - inc_mis)", 
         Approach = "Subtraction", Reliability = .)

rel_ccfe_d_subt_subt
```

Regression of Congruency (composite effect) in d [regression of subtraction]
```{r}
rel_ccfe_d_subt_regr <- rel_reg(rel_ccf_d_cong_a_subt, rel_ccf_d_cong_m_subt, 
                                ccfe_d$cong_ali_subt, ccfe_d$cong_mis_subt) %>% 
  tibble(DV = "d", Condition = "(con_ali - inc_ali) ~ (con_mis - inc_mis)", 
         Approach = "Regression", Reliability = .)

rel_ccfe_d_subt_regr
```

Subtraction of Congruency (composite effect) in d [subtraction of regression]
```{r}
rel_ccfe_d_regr_subt <- rel_sub(rel_ccf_d_cong_a_regr, rel_ccf_d_cong_m_regr, 
                                ccfe_d$cong_ali_regr, ccfe_d$cong_mis_regr) %>% 
  tibble(DV = "d", Condition = "(con_ali ~ inc_ali) - (con_mis ~ inc_mis)", 
         Approach = "Subtraction", Reliability = .)

rel_ccfe_d_regr_subt
```


Regression of Congruency (composite effect) in d [regression of regression]
```{r}
rel_ccfe_d_regr_regr <- rel_reg(rel_ccf_d_cong_a_regr, rel_ccf_d_cong_m_regr, 
                                ccfe_d$cong_ali_regr, ccfe_d$cong_mis_regr) %>% 
  tibble(DV = "d", Condition = "(con_ali ~ inc_ali) ~ (con_mis ~ inc_mis)", 
         Approach = "Regression", Reliability = .)

rel_ccfe_d_regr_regr
```

Subtraction of RT [subtraction of subtraction]
```{r}
rel_ccfe_rt_subt_subt <- rel_sub(rel_ccf_rt_cong_a_subt, rel_ccf_rt_cong_m_subt,
                                 ccfe_rt$cong_ali_subt, ccfe_rt$cong_mis_subt) %>% 
  tibble(DV = "rt", Condition = "(con_ali - inc_ali) - (con_mis - inc_mis)", 
         Approach = "Subtraction", Reliability = .)

rel_ccfe_rt_subt_subt
```

Regression of RT [regression of subtraction]
```{r}
rel_ccfe_rt_subt_regr <- rel_reg(rel_ccf_rt_cong_a_subt, rel_ccf_rt_cong_m_subt,
                                 ccfe_rt$cong_ali_subt, ccfe_rt$cong_mis_subt) %>% 
  tibble(DV = "rt", Condition = "(con_ali - inc_ali) ~ (con_mis - inc_mis)", 
         Approach = "Regression", Reliability = .)

rel_ccfe_rt_subt_regr
```

Regression of RT [subtraction of regression]
```{r}
rel_ccfe_rt_regr_subt <- rel_sub(rel_ccf_rt_cong_a_regr, rel_ccf_rt_cong_m_regr,
                                 ccfe_rt$cong_ali_regr, ccfe_rt$cong_mis_regr) %>% 
  tibble(DV = "rt", Condition = "(con_ali ~ inc_ali) - (con_mis ~ inc_mis)", 
         Approach = "Subtraction", Reliability = .)

rel_ccfe_rt_regr_subt
```


Regression of RT [regression of regression]
```{r}
rel_ccfe_rt_regr_regr <- rel_reg(rel_ccf_rt_cong_a_regr, rel_ccf_rt_cong_m_regr,
                                 ccfe_rt$cong_ali_regr, ccfe_rt$cong_mis_regr) %>% 
  tibble(DV = "rt", Condition = "(con_ali ~ inc_ali) ~ (con_mis ~ inc_mis)", 
         Approach = "Regression", Reliability = .)

rel_ccfe_rt_regr_regr
```

#### Interim summary 

```{r}
rel_sum_ccf <- 
  bind_rows(rel_ccf_beha_ca, rel_ccf_beha_ia, rel_ccf_beha_cm, rel_ccf_beha_im, rel_ccf_beha_iso, # each condition
            rel_ccf_rt_ca, rel_ccf_rt_ia, rel_ccf_rt_cm, rel_ccf_rt_im, rel_ccf_rt_iso, # each condition
            rel_ccf_d_ca, rel_ccf_d_ia, rel_ccf_d_cm, rel_ccf_d_im, rel_ccf_d_iso, # each condition
            rel_fac_d_iso_subt, rel_fac_d_iso_regr, rel_fac_rt_iso_subt, rel_fac_rt_iso_regr, # facilitation (isolated)
            rel_fac_d_subt, rel_fac_d_regr, rel_fac_rt_subt, rel_fac_rt_regr, # facilitation 
            rel_int_d_iso_subt, rel_int_d_iso_regr, rel_int_rt_iso_subt, rel_int_rt_iso_regr, # interference (isolated)
            rel_int_d_subt, rel_int_d_regr, rel_int_rt_subt, rel_int_rt_regr, # interference 
            rel_ccf_d_cong_a_subt, rel_ccf_d_cong_m_subt, rel_ccf_rt_cong_a_subt, rel_ccf_rt_cong_m_subt, # congruency effects (subtraction)
            rel_ccf_d_cong_a_regr, rel_ccf_d_cong_m_regr, rel_ccf_rt_cong_a_regr, rel_ccf_rt_cong_m_regr, # congruency effects (subtraction)
            rel_ccfe_d_subt_subt, rel_ccfe_d_regr_subt, rel_ccfe_d_subt_regr, rel_ccfe_d_regr_regr, # composite effects
            rel_ccfe_rt_subt_subt, rel_ccfe_rt_regr_subt, rel_ccfe_rt_subt_regr, rel_ccfe_rt_regr_regr # composite effects
  ) %>% 
  mutate(Task = "CCF", .before=1)
rel_sum_ccf
```


## Correlations among holistic processing effects

```{r}
# custom function to print the two-sided correlation results via library(psych)
psych_cor2 <- function(.data, ...) {
  
  # .data: data frame only includes columns for correlation (no subject code column)
  # Usage: psych_cor2(hpe_acc_subt)
  
  # run correlations
  cor_tmp <- psych::corr.test(.data, ...)
  
  cor_tmp$ci %>% 
    rename(`lower95`=lower,
           `upper95`=upper) %>% 
    mutate(N = cor_tmp$n,
           p.adj = cor_tmp$p.adj,
           adjust = cor_tmp$adjust,
           alt = "two.sided") %>% 
    bind_cols(cor_tmp$ci.adj %>% mutate(r=1) %>% select(-r)) %>% 
    return()
}
```


```{r}
# custom function to calculate the disattenuated correlation
# Spearman, C. (1904). The proof and measurement of association between two things. The American Journal of Psychology, 15(1), 72â€“101. https://doi.org/10.2307/1412159
# disa_corr <- function(cor.value, rel1, rel2){
#   return(cor.value / sqrt(rel1, rel2))
# }
```


### Subtraction

#### Accuracy & d'
```{r}
hpe_acc_subt <- hpe_acc %>% 
  transmute(pwe_subt, scfe_subt, ccfe_subt_subt) 

hpe_rt_subt <- hpe_rt %>% 
  transmute(pwe_subt, scfe_subt, ccfe_subt_subt)
```

Correlations among holistic effects (accuracy or d' with subtraction):
```{r}
corPlot(hpe_acc_subt)
```

Correlations among holistic processing effects of accuracy (subtraction):
```{r}
cor_hpe_acc_subt <- psych_cor2(hpe_acc_subt) %>% 
  rownames_to_column("pair") %>% 
  mutate(DV = "acc", 
         pair = c("pwe_subt ~ scfe_subt", "ccfe_subt ~ pwe_subt", "ccfe_subt ~ scfe_subt"),
         up_bound = c(
           upper_boundary(rel_pwe_acc_subt, rel_scfe_acc_subt),
           upper_boundary(rel_pwe_acc_subt, rel_ccfe_d_subt_subt),
           upper_boundary(rel_scfe_acc_subt, rel_ccfe_d_subt_subt)
         ), 
         r_corr = r/up_bound,
         .before = 1) 

cor_hpe_acc_subt
```

```{r}
plot_pwe_scfe_acc_subt <- ggplot(hpe_acc, aes(x=pwe_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Part-whole difference scores (accuracy)", 
       y = "Standard composite difference scores (accuracy)     ") +
  coord_cartesian(ylim = c(-.35, .6)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")",
                          cor_hpe_acc_subt$r[1], 
                          cor_hpe_acc_subt$r_corr[1], 
                          cor_hpe_acc_subt$p[1]))
plot_pwe_scfe_acc_subt
```

```{r}
plot_ccfe_pwe_acc_subt <- ggplot(hpe_acc, aes(x=ccfe_subt_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Complete composite difference scores ("*italic("d'")*")"), 
       y = "Part-whole difference scores (accuracy)") +
  # coord_cartesian(ylim = c(-.35, .6)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_acc_subt$r[2], 
                          cor_hpe_acc_subt$r_corr[2], 
                          cor_hpe_acc_subt$p[2]))
plot_ccfe_pwe_acc_subt
```

```{r}
plot_ccfe_scfe_acc_subt <- ggplot(hpe_acc, aes(x=ccfe_subt_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Complete composite difference scores ("*italic("d'")*")"), 
       y = "Standard composite difference scores (accuracy)     ") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.3f\")", 
                          cor_hpe_acc_subt$r[3], 
                          cor_hpe_acc_subt$r_corr[3], 
                          cor_hpe_acc_subt$p[3]))
plot_ccfe_scfe_acc_subt
```

#### RT

Correlations among holistic effects (RT):
```{r}
corPlot(hpe_rt_subt)
```

Correlations among holistic processing effects of RT (subtraction)
```{r}
cor_hpe_rt_subt <- psych_cor2(hpe_rt_subt) %>% 
  rownames_to_column("pair") %>% 
  mutate(DV = "rt", 
         pair = c("pwe_subt ~ scfe_subt", "ccfe_subt ~ pwe_subt", "ccfe_subt ~ scfe_subt"),
         up_bound = c(
           upper_boundary(rel_pwe_rt_subt, rel_scfe_rt_subt),
           upper_boundary(rel_pwe_rt_subt, rel_ccfe_rt_subt_subt),
           upper_boundary(rel_scfe_rt_subt, rel_ccfe_rt_subt_subt)
         ), 
         r_corr = r/up_bound, 
         .before = 1) 
cor_hpe_rt_subt
```

```{r}
plot_pwe_scfe_rt_subt <- ggplot(hpe_rt, aes(x=pwe_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Part-whole difference scores (RT)", 
       y = "Standard composite difference scores (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_rt_subt$r[1], 
                          cor_hpe_rt_subt$r_corr[1], 
                          cor_hpe_rt_subt$p[1]))

plot_pwe_scfe_rt_subt
```

```{r}
plot_ccfe_pwe_rt_subt <- ggplot(hpe_rt, aes(x=ccfe_subt_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Complete composite difference scores (RT)", 
       y = "Part-whole difference scores (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_rt_subt$r[2], 
                          cor_hpe_rt_subt$r_corr[2], 
                          cor_hpe_rt_subt$p[2]))
plot_ccfe_pwe_rt_subt
```

```{r}
plot_ccfe_scfe_rt_subt <- ggplot(hpe_rt, aes(x=ccfe_subt_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Complete composite difference scores (RT)", 
       y = "Standard composite difference scores (RT)") +
  coord_cartesian(ylim = c(-600, 1000)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_rt_subt$r[3], 
                          cor_hpe_rt_subt$r_corr[3], 
                          cor_hpe_rt_subt$p[3]))
plot_ccfe_scfe_rt_subt
```

#### Plot
```{r fig.width=12, fig.asp=.66}
ggarrange(plot_pwe_scfe_acc_subt, plot_ccfe_pwe_acc_subt, plot_ccfe_scfe_acc_subt,
          plot_pwe_scfe_rt_subt, plot_ccfe_pwe_rt_subt, plot_ccfe_scfe_rt_subt,
          nrow = 2, ncol = 3)
```


### Regression

#### Accuracy & d'
```{r}
hpe_acc_regr <- hpe_acc %>% 
  transmute(pwe_regr, scfe_regr, ccfe_subt_regr)

hpe_rt_regr <- hpe_rt %>% 
  transmute(pwe_regr, scfe_regr, ccfe_subt_regr)
```

Correlations among holistic effects (accuracy or d' with regression):
```{r}
corPlot(hpe_acc_regr)
```

Correlations among holistic processing effects of accuracy (regression)
```{r}
cor_hpe_acc_regr <- psych_cor2(hpe_acc_regr) %>% 
  rownames_to_column("pair") %>% 
  mutate(DV = "acc", 
         pair = c("pwe_regr ~ scfe_regr", "ccfe_regr ~ pwe_regr", "ccfe_regr ~ scfe_regr"),
         up_bound = c(
           upper_boundary(rel_pwe_acc_regr, rel_scfe_acc_regr),
           upper_boundary(rel_pwe_acc_regr, rel_ccfe_d_subt_regr),
           upper_boundary(rel_scfe_acc_regr, rel_ccfe_d_subt_regr)
         ), 
         r_corr = r/up_bound, 
         .before = 1) 
cor_hpe_acc_regr
```

```{r}
plot_pwe_scfe_acc_regr <- ggplot(hpe_acc, aes(x=pwe_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Part-whole residuals (accuracy)", 
       y = "Standard composite residuals (accuracy)") +
  coord_cartesian(ylim=c(-.3, .45)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_acc_regr$r[1], 
                          cor_hpe_acc_regr$r_corr[1], 
                          cor_hpe_acc_regr$p[1]))
plot_pwe_scfe_acc_regr
```

```{r}
plot_ccfe_pwe_acc_regr <- ggplot(hpe_acc, aes(x=ccfe_subt_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Complete composite residuals ("*italic("d'")*")"), 
       y = "Part-whole residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.3f\")", 
                          cor_hpe_acc_regr$r[2], 
                          cor_hpe_acc_regr$r_corr[2], 
                          cor_hpe_acc_regr$p[2]))
plot_ccfe_pwe_acc_regr
```

```{r}
plot_ccfe_scfe_acc_regr <- ggplot(hpe_acc, aes(x=ccfe_subt_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Complete composite residuals ("*italic("d'")*")"), 
       y = "Standard composite residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.4f\")", 
                          cor_hpe_acc_regr$r[3], 
                          cor_hpe_acc_regr$r_corr[3], 
                          cor_hpe_acc_regr$p[3]))
plot_ccfe_scfe_acc_regr
```

#### RT
Correlations among holistic effects (RT with regression):
```{r}
corPlot(hpe_rt_regr)
```

Correlations among holistic processing effects of RT (regression)
```{r}
cor_hpe_rt_regr <- psych_cor2(hpe_rt_regr) %>% 
  rownames_to_column("pair") %>% 
  mutate(DV = "rt", 
         pair = c("pwe_regr ~ scfe_regr", "ccfe_regr ~ pwe_regr", "ccfe_regr ~ scfe_regr"),
         up_bound = c(
           upper_boundary(rel_pwe_rt_regr, rel_scfe_rt_regr),
           upper_boundary(rel_pwe_rt_regr, rel_ccfe_rt_subt_regr),
           upper_boundary(rel_scfe_rt_regr, rel_ccfe_rt_subt_regr)
         ), 
         r_corr = r/up_bound,
         .before = 1) 
cor_hpe_rt_regr
```

```{r}
plot_pwe_scfe_rt_regr <- ggplot(hpe_rt, aes(x=pwe_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Part-whole residuals (RT)", 
       y = "Standard composite residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_rt_regr$r[1], 
                          cor_hpe_rt_regr$r_corr[1], 
                          cor_hpe_rt_regr$p[1]))
plot_pwe_scfe_rt_regr
```

```{r}
plot_ccfe_pwe_rt_regr <- ggplot(hpe_rt, aes(x=ccfe_subt_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Complete composite residuals (RT)", 
       y = "Part-whole residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_rt_regr$r[2], 
                          cor_hpe_rt_regr$r_corr[2], 
                          cor_hpe_rt_regr$p[2]))
plot_ccfe_pwe_rt_regr
```

```{r}
plot_ccfe_scfe_rt_regr <- ggplot(hpe_rt, aes(x=ccfe_subt_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Complete composite residuals (RT)", 
       y = "Standard composite residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_rt_regr$r[3], 
                          cor_hpe_rt_regr$r_corr[3], 
                          cor_hpe_rt_regr$p[3]))
plot_ccfe_scfe_rt_regr
```

#### Plot
```{r fig.width=12, fig.asp=.66}
ggarrange(plot_pwe_scfe_acc_regr, plot_ccfe_pwe_acc_regr, plot_ccfe_scfe_acc_regr,
          plot_pwe_scfe_rt_regr, plot_ccfe_pwe_rt_regr, plot_ccfe_scfe_rt_regr,
          nrow = 2, ncol = 3)
```

### Interim summary

```{r}
cor_hpe <- bind_rows(cor_hpe_acc_subt, cor_hpe_rt_subt, 
                     cor_hpe_acc_regr, cor_hpe_rt_regr)
cor_hpe
```


## Correlations for facilitation and interference

```{r}
# custom function to print the two-sided correlation results via library(psych)
psych_cor1 <- function(x, y, ...) {
  
  # .data: data frame only includes columns for correlation (no subject code column)
  # Usage: psych_cor1(hpe_acc_subt)
  
  # run correlations
  cor_tmp <- psych::corr.test(x, y, alpha=.1, ...) # one-sided test
  
  rownames(cor_tmp) <- NULL
  
  cor_tmp$ci %>% 
    rename(`lower90`=lower,
           `upper90`=upper) %>% 
    mutate(N = cor_tmp$n,
           p = p/2, # one-sided p-value
           alt = "greater") %>% 
    # bind_cols(cor_tmp$ci.adj %>% mutate(r=1) %>% select(-r)) %>% 
    return()
}
```


```{r}
# calculate the adjusted CI
psych_cor1_adj_CI <- function(.data, alpha=.10){
  # codes are modified from psych::corr.test()
  z <- fisherz(.data$r)
  ord <- order(z, decreasing = FALSE)
  
  dif.corrected <- qnorm(1-alpha/(2*(order(ord))))
  se <- 1/sqrt(.data$N - 3)
  
  # dif <- qnorm(1-alpha/2)
  # lower <- fisherz2r(z - dif * se)
  # upper <- fisherz2r(z + dif * se)
  .data %>% 
    mutate(lower.adj=fisherz2r(z - dif.corrected * se),
           upper.adj=fisherz2r(z + dif.corrected * se)) %>% 
    return()
}
```

### PW and Facilitation in CCF

#### Subtraction

accuracy 
```{r}
r_pwe_fac_acc_subt <- psych_cor1(hpe_acc$pwe_subt, hpe_acc$fac_subt) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_subt ~ fac_subt",
         DV = "acc",
         up_bound = upper_boundary(rel_pwe_acc_subt, rel_fac_d_subt),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_fac_acc_subt
```

```{r}
ggplot(hpe_acc, aes(x=fac_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (d')",
       y = "Part-whole difference scores (accuracy)") +
  coord_cartesian(ylim = c(-.23, .35)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f \")",
                          r_pwe_fac_acc_subt$r, 
                          r_pwe_fac_acc_subt$r_corr, 
                          r_pwe_fac_acc_subt$p))
```

accuracy isolated
```{r}
r_pwe_fac_iso_acc_subt <- psych_cor1(hpe_acc$pwe_subt, hpe_acc$fac_subt_iso) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_subt ~ fac_subt_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_pwe_acc_subt, rel_fac_d_iso_subt),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_fac_iso_acc_subt
```

```{r}
ggplot(hpe_acc, aes(x=fac_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (d')",
       y = "Part-whole difference scores (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_fac_iso_acc_subt$r, 
                          r_pwe_fac_iso_acc_subt$r_corr, 
                          r_pwe_fac_iso_acc_subt$p))
```

RT 
```{r}
r_pwe_fac_rt_subt <- psych_cor1(hpe_rt$pwe_subt, hpe_rt$fac_subt) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_subt ~ fac_subt",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_subt, rel_fac_rt_subt),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_fac_rt_subt
```

```{r}
ggplot(hpe_rt, aes(x=fac_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (RT)",
       y = "Part-whole difference scores (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_fac_rt_subt$r, 
                          r_pwe_fac_rt_subt$r_corr, 
                          r_pwe_fac_rt_subt$p))
```

RT isolated
```{r}
r_pwe_fac_iso_rt_subt <- psych_cor1(hpe_rt$pwe_subt, hpe_rt$fac_subt_iso) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_subt ~ fac_subt_iso",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_subt, rel_fac_rt_iso_subt),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_fac_iso_rt_subt
```

```{r}
ggplot(hpe_rt, aes(x=fac_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (RT)",
       y = "Part-whole difference scores (RT)") +
  coord_cartesian(ylim = c(-750, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_fac_iso_rt_subt$r, 
                          r_pwe_fac_iso_rt_subt$r_corr, 
                          r_pwe_fac_iso_rt_subt$p))
```

#### Regressions
Accuracy
```{r}
r_pwe_fac_acc_regr <- psych_cor1(hpe_acc$pwe_regr, hpe_acc$fac_regr) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_regr ~ fac_regr",
         DV = "acc", 
         up_bound = upper_boundary(rel_pwe_acc_regr, rel_fac_d_regr),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_fac_acc_regr
```

```{r}
ggplot(hpe_acc, aes(x=fac_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (d')",
       y = "Part-whole residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_fac_acc_regr$r, 
                          r_pwe_fac_acc_regr$r_corr, 
                          r_pwe_fac_acc_regr$p))
```

Accuracy isolated
```{r}
r_pwe_fac_iso_acc_regr <- psych_cor1(hpe_acc$pwe_regr, hpe_acc$fac_regr_iso) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_regr ~ fac_regr_iso",
         DV = "acc", 
         up_bound = upper_boundary(rel_pwe_acc_regr, rel_fac_d_iso_regr),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_fac_iso_acc_regr
```

```{r}
ggplot(hpe_acc, aes(x=fac_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (d')",
       y = "Part-whole residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_fac_iso_acc_regr$r, 
                          r_pwe_fac_iso_acc_regr$r_corr, 
                          r_pwe_fac_iso_acc_regr$p))
```

RT 
```{r}
r_pwe_fac_rt_regr <- psych_cor1(hpe_rt$pwe_regr, hpe_rt$fac_regr) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_regr ~ fac_regr",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_regr, rel_fac_rt_regr),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_fac_rt_regr
```

```{r}
ggplot(hpe_rt, aes(x=fac_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (RT)",
       y = "Part-whole residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_fac_rt_regr$r, 
                          r_pwe_fac_rt_regr$r_corr, 
                          r_pwe_fac_rt_regr$p))
```

RT isolated
```{r}
r_pwe_fac_iso_rt_regr <- psych_cor1(hpe_rt$pwe_regr, hpe_rt$fac_regr_iso) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_regr ~ fac_regr_iso",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_regr, rel_fac_rt_iso_regr),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_fac_iso_rt_regr
```

```{r}
ggplot(hpe_rt, aes(x=fac_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (RT)",
       y = "Part-whole residuals (RT)") +
  coord_cartesian(ylim = c(-650, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_fac_iso_rt_regr$r, 
                          r_pwe_fac_iso_rt_regr$r_corr, 
                          r_pwe_fac_iso_rt_regr$p))
```

#### Interim summary

```{r}
r_sum_pwe_fac <- bind_rows(r_pwe_fac_acc_subt, r_pwe_fac_iso_acc_subt,
                           r_pwe_fac_rt_subt, r_pwe_fac_iso_rt_subt,
                           r_pwe_fac_acc_regr, r_pwe_fac_iso_acc_regr,
                           r_pwe_fac_rt_regr, r_pwe_fac_iso_rt_regr)
```

Corrections for the baseline of isolated:
```{r}
r_pwe_fac_iso <- r_sum_pwe_fac %>% 
  filter(endsWith(pair, "_iso")) %>% 
  mutate(p.adj = p.adjust(p, method = "holm"),
         adjust="holm") %>%  # apply Holm-Bonferroni
  psych_cor1_adj_CI() %>% 
  mutate(effect = "Facilitation")
r_pwe_fac_iso
```

```{r}
plot_pwe_fac_acc_subt_iso <- ggplot(hpe_acc, aes(x=fac_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation difference scores ("*italic("d'")*")"),
       y = "Part-whole difference scores (accuracy)") +
  scale_y_continuous(breaks=seq(-.2, .3, .1)) +
  coord_cartesian(ylim = c(-.25, .36)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_fac_iso_acc_subt$r, 
                          r_pwe_fac_iso_acc_subt$r_corr,
                          r_pwe_fac_iso_acc_subt$p,
                          r_pwe_fac_iso$p.adj[1]))
plot_pwe_fac_acc_subt_iso
```


```{r}
plot_pwe_fac_rt_subt_iso <- ggplot(hpe_rt, aes(x=fac_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (RT)",
       y = "Part-whole difference scores (RT)") +
  coord_cartesian(ylim = c(-770, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_fac_iso_rt_subt$r, 
                          r_pwe_fac_iso_rt_subt$r_corr, 
                          r_pwe_fac_iso_rt_subt$p,
                          r_pwe_fac_iso$p.adj[2]))
plot_pwe_fac_rt_subt_iso
```


```{r}
plot_pwe_fac_acc_regr_iso <-ggplot(hpe_acc, aes(x=fac_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation residuals ("*italic("d'")*")"),
       y = "Part-whole residuals (accuracy)") +
  scale_x_continuous(breaks=seq(-2, 2, .5)) +
  scale_y_continuous(breaks=seq(-.4, .2, .1)) +
  coord_cartesian(ylim = c(-.35, .19)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_fac_iso_acc_regr$r, 
                          r_pwe_fac_iso_acc_regr$r_corr, 
                          r_pwe_fac_iso_acc_regr$p,
                          r_pwe_fac_iso$p.adj[3]))
plot_pwe_fac_acc_regr_iso
```



```{r}
plot_pwe_fac_rt_regr_iso <- ggplot(hpe_rt, aes(x=fac_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (RT)",
       y = "Part-whole residuals (RT)") +
  # scale_y_continuous(breaks = seq(-500, 1000, 250)) +
  scale_x_continuous(breaks = seq(-750, 500, 250)) +
  coord_cartesian(ylim = c(-650, 1200), xlim = c(-770, 550)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_fac_iso_rt_regr$r, 
                          r_pwe_fac_iso_rt_regr$r_corr, 
                          r_pwe_fac_iso_rt_regr$p,
                          r_pwe_fac_iso$p.adj[4]))
plot_pwe_fac_rt_regr_iso
```


```{r fig.width=12, fig.asp=1}
ggarrange(plot_pwe_fac_acc_subt_iso, plot_pwe_fac_rt_subt_iso,
          plot_pwe_fac_acc_regr_iso, plot_pwe_fac_rt_regr_iso,
          nrow=2, ncol=2)
```

Corrections for the misaligned baseline:
```{r}
r_pwe_fac <- r_sum_pwe_fac %>% 
  filter(!endsWith(pair, "_iso")) %>% 
  mutate(p.adj = p.adjust(p, method = "holm"),
         adjust="holm") %>%  # apply Holm-Bonferroni
  psych_cor1_adj_CI()
r_pwe_fac
```


```{r}
plot_pwe_fac_acc_subt <- ggplot(hpe_acc, aes(x=fac_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation difference scores ("*italic("d'")*")"),
       y = "Part-whole difference scores (accuracy)") +
  scale_x_continuous(breaks=seq(-2, 2, .5)) +
  scale_y_continuous(breaks=seq(-.4, .4, .1)) +
  coord_cartesian(ylim = c(-.22, .35)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_fac_acc_subt$r, 
                          r_pwe_fac_acc_subt$r_corr, 
                          r_pwe_fac_acc_subt$p,
                          r_pwe_fac$p.adj[1]))
plot_pwe_fac_acc_subt
```

```{r}
plot_pwe_fac_rt_subt <- ggplot(hpe_rt, aes(x=fac_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (RT)",
       y = "Part-whole difference scores (RT)") +
  coord_cartesian(ylim = c(-800, 1100)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")",
                          r_pwe_fac_rt_subt$r, 
                          r_pwe_fac_rt_subt$r_corr, 
                          r_pwe_fac_rt_subt$p,
                          r_pwe_fac$p.adj[2]))
plot_pwe_fac_rt_subt
```

```{r}
plot_pwe_fac_acc_regr <- ggplot(hpe_acc, aes(x=fac_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation residuals ("*italic("d'")*")"),
       y = "Part-whole residuals (accuracy)") +
  coord_cartesian(ylim = c(-.35, .16)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")",
                          r_pwe_fac_acc_regr$r, 
                          r_pwe_fac_acc_regr$r_corr, 
                          r_pwe_fac_acc_regr$p,
                          r_pwe_fac$p.adj[3]))
plot_pwe_fac_acc_regr
```

```{r}
plot_pwe_fac_rt_regr <- ggplot(hpe_rt, aes(x=fac_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (RT)",
       y = "Part-whole residuals (RT)") +
  coord_cartesian(ylim = c(-700, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_fac_rt_regr$r, 
                          r_pwe_fac_rt_regr$r_corr, 
                          r_pwe_fac_rt_regr$p,
                          r_pwe_fac$p.adj[4]))
plot_pwe_fac_rt_regr
```

```{r fig.width=12, fig.asp=1}
ggarrange(plot_pwe_fac_acc_subt, plot_pwe_fac_rt_subt,
          plot_pwe_fac_acc_regr, plot_pwe_fac_rt_regr,
          nrow=2, ncol=2)
```

### SCF and Interference in CCF

#### Subtraction
Accuracy
```{r}
r_scfe_int_acc_subt <- psych_cor1(hpe_acc$scfe_subt, hpe_acc$int_subt) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_subt ~ int_subt",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_subt, rel_int_d_subt),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_int_acc_subt
```

```{r}
ggplot(hpe_acc, aes(x=int_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (d')",
       y = "Standard composite difference scores (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.4f\")", 
                          r_scfe_int_acc_subt$r, 
                          r_scfe_int_acc_subt$r_corr, 
                          r_scfe_int_acc_subt$p))
```

Accuracy isolated
```{r}
r_scfe_int_iso_acc_subt <- psych_cor1(hpe_acc$scfe_subt, hpe_acc$int_subt_iso) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_subt ~ int_subt_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_subt, rel_int_d_iso_subt),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_int_iso_acc_subt
```

```{r}
ggplot(hpe_acc, aes(x=int_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (d')",
       y = "Standard composite difference scores (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.5f\")", 
                          r_scfe_int_iso_acc_subt$r, 
                          r_scfe_int_iso_acc_subt$r_corr, 
                          r_scfe_int_iso_acc_subt$p))
```

RT 
```{r}
r_scfe_int_rt_subt <- psych_cor1(hpe_rt$scfe_subt, hpe_rt$int_subt) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_subt ~ int_subt",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_subt, rel_int_rt_subt),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_int_rt_subt
```

```{r}
ggplot(hpe_rt, aes(x=int_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (RT)",
       y = "Standard composite difference scores (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_scfe_int_rt_subt$r, 
                          r_scfe_int_rt_subt$r_corr, 
                          r_scfe_int_rt_subt$p))
```

RT isolated
```{r}
r_scfe_int_iso_rt_subt <- psych_cor1(hpe_rt$scfe_subt, hpe_rt$int_subt_iso) %>%
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_subt ~ int_subt_iso",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_subt, rel_int_rt_iso_subt),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_int_iso_rt_subt
```

```{r}
ggplot(hpe_rt, aes(x=int_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (RT)",
       y = "Standard composite difference scores (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.3f\")",  
                          r_scfe_int_iso_rt_subt$r, 
                          r_scfe_int_iso_rt_subt$r_corr, 
                          r_scfe_int_iso_rt_subt$p))
```

#### Regressions
Accuracy
```{r}
r_scfe_int_acc_regr <- psych_cor1(hpe_acc$scfe_regr, hpe_acc$int_regr) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_regr ~ int_regr",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_regr, rel_int_d_regr),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_int_acc_regr
```

```{r}
ggplot(hpe_acc, aes(x=int_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (d')",
       y = "Standard composite residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.5f\")", 
                          r_scfe_int_acc_regr$r, 
                          r_scfe_int_acc_regr$r_corr, 
                          r_scfe_int_acc_regr$p))
```

Accuracy isolated
```{r}
r_scfe_int_iso_acc_regr <- psych_cor1(hpe_acc$scfe_regr, hpe_acc$int_regr_iso) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_regr ~ int_regr_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_regr, rel_int_d_iso_regr),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_int_iso_acc_regr
```

```{r}
ggplot(hpe_acc, aes(x=int_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (d')",
       y = "Standard composite residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.5f\")", 
                          r_scfe_int_iso_acc_regr$r, 
                          r_scfe_int_iso_acc_regr$r_corr, 
                          r_scfe_int_iso_acc_regr$p))
```

RT
```{r}
r_scfe_int_rt_regr <- psych_cor1(hpe_rt$scfe_regr, hpe_rt$int_regr) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_regr ~ int_regr",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_regr, rel_int_rt_regr),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_int_rt_regr
```

```{r}
ggplot(hpe_rt, aes(x=int_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (RT)",
       y = "Standard composite residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_scfe_int_rt_regr$r, 
                          r_scfe_int_rt_regr$r_corr, 
                          r_scfe_int_rt_regr$p))
```

RT isolated
```{r}
r_scfe_int_iso_rt_regr <- psych_cor1(hpe_rt$scfe_regr, hpe_rt$int_regr_iso) %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_regr ~ int_regr_iso",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_regr, rel_int_rt_iso_regr),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_int_iso_rt_regr
```

```{r}
ggplot(hpe_rt, aes(x=int_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (RT)",
       y = "Standard composite residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_scfe_int_iso_rt_regr$r, 
                          r_scfe_int_iso_rt_regr$r_corr, 
                          r_scfe_int_iso_rt_regr$p))
```

#### Interim summary

```{r}
r_sum_scfe_int <- bind_rows(r_scfe_int_acc_subt, r_scfe_int_iso_acc_subt,
                            r_scfe_int_rt_subt, r_scfe_int_iso_rt_subt,
                            r_scfe_int_acc_regr, r_scfe_int_iso_acc_regr,
                            r_scfe_int_rt_regr, r_scfe_int_iso_rt_regr) 
```

Corrections for the baseline of isolated:
```{r}
r_scfe_int_iso <- r_sum_scfe_int %>% 
  filter(endsWith(pair, "_iso")) %>% 
  mutate(p.adj = p.adjust(p, method = "holm"),
         adjust="holm") %>%  # apply Holm-Bonferroni
  psych_cor1_adj_CI() %>% 
  mutate(effect = "Interference")
r_scfe_int_iso
```

```{r}
plot_scfe_int_acc_subt_iso <- ggplot(hpe_acc, aes(x=int_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference difference scores ("*italic("d'")*")"),
       y = "Standard composite difference scores (accuracy)     ") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.5f, \",
                          italic(p)[adj], \" = %0.5f\")", 
                          r_scfe_int_iso_acc_subt$r, 
                          r_scfe_int_iso_acc_subt$r_corr, 
                          r_scfe_int_iso_acc_subt$p,
                          r_scfe_int_iso$p.adj[1]))
plot_scfe_int_acc_subt_iso
```

```{r}
plot_scfe_int_rt_subt_iso <- ggplot(hpe_rt, aes(x=int_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (RT)",
       y = "Standard composite difference scores (RT)") +
  scale_x_continuous(breaks=seq(-500, 1000, 250)) +
  coord_cartesian(ylim = c(-1100, 600)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.3f, \",
                          italic(p)[adj], \" = %0.3f\")", 
                          r_scfe_int_iso_rt_subt$r, 
                          r_scfe_int_iso_rt_subt$r_corr, 
                          r_scfe_int_iso_rt_subt$p,
                          r_scfe_int_iso$p.adj[2]))
plot_scfe_int_rt_subt_iso
```

```{r}
plot_scfe_int_acc_regr_iso <- ggplot(hpe_acc, aes(x=int_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference residuals ("*italic("d'")*")"),
       y = "Standard composite residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" < 0.00001, \",
                          italic(p)[adj], \" < 0.00001\")", 
                          r_scfe_int_iso_acc_regr$r,
                          r_scfe_int_iso_acc_regr$r_corr)) 
plot_scfe_int_acc_regr_iso
```

```{r}
plot_scfe_int_rt_regr_iso <- ggplot(hpe_rt, aes(x=int_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (RT)",
       y = "Standard composite residuals (RT)") +
  coord_cartesian(ylim = c(-730, 470), xlim = c(-620, 600)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_int_iso_rt_regr$r, 
                          r_scfe_int_iso_rt_regr$r_corr, 
                          r_scfe_int_iso_rt_regr$p,
                          r_scfe_int_iso$p.adj[4]))
plot_scfe_int_rt_regr_iso
```

```{r fig.width=12, fig.asp=1}
ggarrange(plot_scfe_int_acc_subt_iso, plot_scfe_int_rt_subt_iso,
          plot_scfe_int_acc_regr_iso, plot_scfe_int_rt_regr_iso,
          nrow=2, ncol=2)
```

Corrections for the misaligned baseline:
```{r}
r_scfe_int <- r_sum_scfe_int %>% 
  filter(!endsWith(pair, "_iso")) %>% 
  mutate(p.adj = p.adjust(p, method = "holm"),
         adjust="holm") %>%  # apply Holm-Bonferroni
  psych_cor1_adj_CI()
r_scfe_int
```

```{r}
plot_scfe_int_acc_subt <- ggplot(hpe_acc, aes(x=int_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference difference scores ("*italic("d'")*")"),
       y = "Standard composite difference scores (accuracy)     ") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.4f, \",
                          italic(p)[adj], \" = %0.3f\")", 
                          r_scfe_int_acc_subt$r, 
                          r_scfe_int_acc_subt$r_corr, 
                          r_scfe_int_acc_subt$p,
                          r_scfe_int$p.adj[1]))
plot_scfe_int_acc_subt
```

```{r}
plot_scfe_int_rt_subt <- ggplot(hpe_rt, aes(x=int_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (RT)",
       y = "Standard composite difference scores (RT)") +
  coord_cartesian(ylim = c(-1100, 500)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_int_rt_subt$r, 
                          r_scfe_int_rt_subt$r_corr, 
                          r_scfe_int_rt_subt$p,
                          r_scfe_int$p.adj[2]))
plot_scfe_int_rt_subt
```

```{r}
plot_scfe_int_acc_regr <- ggplot(hpe_acc, aes(x=int_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference residuals ("*italic("d'")*")"),
       y = "Standard composite residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" < 0.00001, \",
                          italic(p)[adj], \" = %0.5f\")", 
                          r_scfe_int_acc_regr$r, 
                          r_scfe_int_acc_regr$r_corr, 
                          # r_scfe_int_acc_regr$p,
                          r_scfe_int$p.adj[3]))
plot_scfe_int_acc_regr
```

```{r}
plot_scfe_int_rt_regr <- ggplot(hpe_rt, aes(x=int_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (RT)",
       y = "Standard composite residuals (RT)") +
  scale_x_continuous(breaks=seq(-600, 600, 300)) +
  coord_cartesian(ylim = c(-720, 380), xlim = c(-620, 600)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_int_rt_regr$r, 
                          r_scfe_int_rt_regr$r_corr, 
                          r_scfe_int_rt_regr$p,
                          r_scfe_int$p.adj[4]))
plot_scfe_int_rt_regr
```


```{r fig.width=12, fig.asp=1}
ggarrange(plot_scfe_int_acc_subt, plot_scfe_int_rt_subt,
          plot_scfe_int_acc_regr, plot_scfe_int_rt_regr,
          nrow=2, ncol=2)
```

### PW and Interference in CCF (non-registered) 
Two-sided tests will be performed.

#### Subtraction

accuracy 
```{r}
r_pwe_int_acc_subt <- bind_cols(hpe_acc['pwe_subt'],
                                hpe_acc['int_subt']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_subt ~ int_subt",
         DV = "acc",
         up_bound = upper_boundary(rel_pwe_acc_subt, rel_int_d_subt),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_int_acc_subt
```

```{r}
ggplot(hpe_acc, aes(x=int_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (d')",
       y = "Part-whole difference scores (accuracy)") +
  coord_cartesian(ylim = c(-.23, .35)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f \")",
                          r_pwe_int_acc_subt$r, 
                          r_pwe_int_acc_subt$r_corr, 
                          r_pwe_int_acc_subt$p))
```

accuracy isolated
```{r}
r_pwe_int_iso_acc_subt <- bind_cols(hpe_acc['pwe_subt'], 
                                    hpe_acc['int_subt_iso']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_subt ~ int_subt_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_pwe_acc_subt, rel_int_d_iso_subt),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_int_iso_acc_subt
```

```{r}
ggplot(hpe_acc, aes(x=int_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (d')",
       y = "Part-whole difference scores (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_int_iso_acc_subt$r, 
                          r_pwe_int_iso_acc_subt$r_corr, 
                          r_pwe_int_iso_acc_subt$p))
```

RT 
```{r}
r_pwe_int_rt_subt <- bind_cols(hpe_rt['pwe_subt'],
                               hpe_rt['int_subt']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_subt ~ int_subt",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_subt, rel_int_rt_subt),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_int_rt_subt
```

```{r}
ggplot(hpe_rt, aes(x=int_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (RT)",
       y = "Part-whole difference scores (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_int_rt_subt$r, 
                          r_pwe_int_rt_subt$r_corr, 
                          r_pwe_int_rt_subt$p))
```

RT isolated
```{r}
r_pwe_int_iso_rt_subt <- bind_cols(hpe_rt['pwe_subt'], 
                                   hpe_rt['int_subt_iso']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_subt ~ int_subt_iso",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_subt, rel_int_rt_iso_subt),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_int_iso_rt_subt
```

```{r}
ggplot(hpe_rt, aes(x=int_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (RT)",
       y = "Part-whole difference scores (RT)") +
  coord_cartesian(ylim = c(-750, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_int_iso_rt_subt$r, 
                          r_pwe_int_iso_rt_subt$r_corr, 
                          r_pwe_int_iso_rt_subt$p))
```

#### Regressions
Accuracy
```{r}
r_pwe_int_acc_regr <- bind_cols(hpe_acc['pwe_regr'], 
                                hpe_acc['int_regr']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_regr ~ int_regr",
         DV = "acc", 
         up_bound = upper_boundary(rel_pwe_acc_regr, rel_int_d_regr),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_int_acc_regr
```

```{r}
ggplot(hpe_acc, aes(x=int_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (d')",
       y = "Part-whole residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_int_acc_regr$r, 
                          r_pwe_int_acc_regr$r_corr, 
                          r_pwe_int_acc_regr$p))
```

Accuracy isolated
```{r}
r_pwe_int_iso_acc_regr <- bind_cols(hpe_acc['pwe_regr'], 
                                    hpe_acc['int_regr_iso']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_regr ~ int_regr_iso",
         DV = "acc", 
         up_bound = upper_boundary(rel_pwe_acc_regr, rel_int_d_iso_regr),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_int_iso_acc_regr
```

```{r}
ggplot(hpe_acc, aes(x=int_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (d')",
       y = "Part-whole residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_int_iso_acc_regr$r, 
                          r_pwe_int_iso_acc_regr$r_corr, 
                          r_pwe_int_iso_acc_regr$p))
```

RT 
```{r}
r_pwe_int_rt_regr <- bind_cols(hpe_rt['pwe_regr'], 
                               hpe_rt['int_regr']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_regr ~ int_regr",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_regr, rel_int_rt_regr),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_int_rt_regr
```

```{r}
ggplot(hpe_rt, aes(x=int_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (RT)",
       y = "Part-whole residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_int_rt_regr$r, 
                          r_pwe_int_rt_regr$r_corr, 
                          r_pwe_int_rt_regr$p))
```

RT isolated
```{r}
r_pwe_int_iso_rt_regr <- bind_cols(hpe_rt['pwe_regr'], 
                                   hpe_rt['int_regr_iso']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "pwe_regr ~ int_regr_iso",
         DV = "rt", 
         up_bound = upper_boundary(rel_pwe_rt_regr, rel_int_rt_iso_regr),
         r_corr = r/up_bound,
         .before = 1)
r_pwe_int_iso_rt_regr
```

```{r}
ggplot(hpe_rt, aes(x=int_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (RT)",
       y = "Part-whole residuals (RT)") +
  coord_cartesian(ylim = c(-650, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_pwe_int_iso_rt_regr$r, 
                          r_pwe_int_iso_rt_regr$r_corr, 
                          r_pwe_int_iso_rt_regr$p))
```

#### Interim summary

```{r}
r_sum_pwe_int <- bind_rows(r_pwe_int_acc_subt, r_pwe_int_iso_acc_subt,
                           r_pwe_int_rt_subt, r_pwe_int_iso_rt_subt,
                           r_pwe_int_acc_regr, r_pwe_int_iso_acc_regr,
                           r_pwe_int_rt_regr, r_pwe_int_iso_rt_regr)
```

Corrections for the baseline of isolated:
```{r}
r_pwe_int_iso <- r_sum_pwe_int %>% 
  filter(endsWith(pair, "_iso")) %>% 
  mutate(p.adj = p.adjust(p, method = "holm"),
         adjust="holm") %>%  # apply Holm-Bonferroni
  psych_cor1_adj_CI() %>% 
  mutate(effect = "PWE ~ Interference")
r_pwe_int_iso
```

```{r}
plot_pwe_int_acc_subt_iso <- ggplot(hpe_acc, aes(x=int_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference difference scores ("*italic("d'")*")"),
       y = "Part-whole difference scores (accuracy)") +
  scale_y_continuous(breaks=seq(-.2, .3, .1)) +
  coord_cartesian(ylim = c(-.25, .36)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_int_iso_acc_subt$r, 
                          r_pwe_int_iso_acc_subt$r_corr, 
                          r_pwe_int_iso_acc_subt$p,
                          r_pwe_int_iso$p.adj[1]))
plot_pwe_int_acc_subt_iso
```


```{r}
plot_pwe_int_rt_subt_iso <- ggplot(hpe_rt, aes(x=int_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (RT)",
       y = "Part-whole difference scores (RT)") +
  coord_cartesian(ylim = c(-770, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_int_iso_rt_subt$r, 
                          r_pwe_int_iso_rt_subt$r_corr, 
                          r_pwe_int_iso_rt_subt$p,
                          r_pwe_int_iso$p.adj[2]))
plot_pwe_int_rt_subt_iso
```


```{r}
plot_pwe_int_acc_regr_iso <-ggplot(hpe_acc, aes(x=int_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference residuals ("*italic("d'")*")"),
       y = "Part-whole residuals (accuracy)") +
  scale_x_continuous(breaks=seq(-2, 2, .5)) +
  scale_y_continuous(breaks=seq(-.4, .2, .1)) +
  coord_cartesian(ylim = c(-.35, .19)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_int_iso_acc_regr$r, 
                          r_pwe_int_iso_acc_regr$r_corr, 
                          r_pwe_int_iso_acc_regr$p,
                          r_pwe_int_iso$p.adj[3]))
plot_pwe_int_acc_regr_iso
```



```{r}
plot_pwe_int_rt_regr_iso <- ggplot(hpe_rt, aes(x=int_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (RT)",
       y = "Part-whole residuals (RT)") +
  # scale_y_continuous(breaks = seq(-500, 1000, 250)) +
  scale_x_continuous(breaks = seq(-750, 500, 250)) +
  coord_cartesian(ylim = c(-650, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_int_iso_rt_regr$r, 
                          r_pwe_int_iso_rt_regr$r_corr, 
                          r_pwe_int_iso_rt_regr$p,
                          r_pwe_int_iso$p.adj[4]))
plot_pwe_int_rt_regr_iso
```


```{r fig.width=12, fig.asp=1}
ggarrange(plot_pwe_int_acc_subt_iso, plot_pwe_int_rt_subt_iso,
          plot_pwe_int_acc_regr_iso, plot_pwe_int_rt_regr_iso,
          nrow=2, ncol=2)
```

Corrections for the misaligned baseline:
```{r}
r_pwe_int <- r_sum_pwe_int %>% 
  filter(!endsWith(pair, "_iso")) %>% 
  mutate(p.adj = p.adjust(p, method = "holm"),
         adjust="holm") %>%  # apply Holm-Bonferroni
  psych_cor1_adj_CI()
r_pwe_int
```


```{r}
plot_pwe_int_acc_subt <- ggplot(hpe_acc, aes(x=int_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference difference scores ("*italic("d'")*")"),
       y = "Part-whole difference scores (accuracy)") +
  scale_x_continuous(breaks=seq(-2, 2, .5)) +
  scale_y_continuous(breaks=seq(-.4, .4, .1)) +
  coord_cartesian(ylim = c(-.22, .35)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_int_acc_subt$r, 
                          r_pwe_int_acc_subt$r_corr, 
                          r_pwe_int_acc_subt$p,
                          r_pwe_int$p.adj[1]))
plot_pwe_int_acc_subt
```

```{r}
plot_pwe_int_rt_subt <- ggplot(hpe_rt, aes(x=int_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference difference scores (RT)",
       y = "Part-whole difference scores (RT)") +
  coord_cartesian(ylim = c(-800, 1100)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")",
                          r_pwe_int_rt_subt$r, 
                          r_pwe_int_rt_subt$r_corr, 
                          r_pwe_int_rt_subt$p,
                          r_pwe_int$p.adj[2]))
plot_pwe_int_rt_subt
```

```{r}
plot_pwe_int_acc_regr <- ggplot(hpe_acc, aes(x=int_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference residuals ("*italic("d'")*")"),
       y = "Part-whole residuals (accuracy)") +
  coord_cartesian(ylim = c(-.35, .16)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")",
                          r_pwe_int_acc_regr$r, 
                          r_pwe_int_acc_regr$r_corr, 
                          r_pwe_int_acc_regr$p,
                          r_pwe_int$p.adj[3]))
plot_pwe_int_acc_regr
```

```{r}
plot_pwe_int_rt_regr <- ggplot(hpe_rt, aes(x=int_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Interference residuals (RT)",
       y = "Part-whole residuals (RT)") +
  coord_cartesian(ylim = c(-700, 1200)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_int_rt_regr$r, 
                          r_pwe_int_rt_regr$r_corr, 
                          r_pwe_int_rt_regr$p,
                          r_pwe_int$p.adj[4]))
plot_pwe_int_rt_regr
```

```{r fig.width=12, fig.asp=1}
ggarrange(plot_pwe_int_acc_subt, plot_pwe_int_rt_subt,
          plot_pwe_int_acc_regr, plot_pwe_int_rt_regr,
          nrow=2, ncol=2)
```


### SCF and Facilitation in CCF (non-registered) 
Two-sided tests will be performed.

#### Subtraction
Accuracy
```{r}
r_scfe_fac_acc_subt <- bind_cols(hpe_acc['scfe_subt'],
                                 hpe_acc['fac_subt']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_subt ~ fac_subt",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_subt, rel_fac_d_subt),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_fac_acc_subt
```

```{r}
ggplot(hpe_acc, aes(x=fac_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (d')",
       y = "Standard composite difference scores (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.4f\")", 
                          r_scfe_fac_acc_subt$r, 
                          r_scfe_fac_acc_subt$r_corr, 
                          r_scfe_fac_acc_subt$p))
```

Accuracy isolated
```{r}
r_scfe_fac_iso_acc_subt <- bind_cols(hpe_acc['scfe_subt'],
                                     hpe_acc['fac_subt_iso']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_subt ~ fac_subt_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_subt, rel_fac_d_iso_subt),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_fac_iso_acc_subt
```

```{r}
ggplot(hpe_acc, aes(x=fac_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (d')",
       y = "Standard composite difference scores (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.5f\")", 
                          r_scfe_fac_iso_acc_subt$r, 
                          r_scfe_fac_iso_acc_subt$r_corr, 
                          r_scfe_fac_iso_acc_subt$p))
```

RT 
```{r}
r_scfe_fac_rt_subt <- bind_cols(hpe_rt['scfe_subt'],
                                hpe_rt['fac_subt']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_subt ~ fac_subt",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_subt, rel_fac_rt_subt),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_fac_rt_subt
```

```{r}
ggplot(hpe_rt, aes(x=fac_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (RT)",
       y = "Standard composite difference scores (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_scfe_fac_rt_subt$r, 
                          r_scfe_fac_rt_subt$r_corr, 
                          r_scfe_fac_rt_subt$p))
```

RT isolated
```{r}
r_scfe_fac_iso_rt_subt <- bind_cols(hpe_rt['scfe_subt'],
                                    hpe_rt['fac_subt_iso']) %>% 
  psych_cor2() %>%
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_subt ~ fac_subt_iso",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_subt, rel_fac_rt_iso_subt),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_fac_iso_rt_subt
```

```{r}
ggplot(hpe_rt, aes(x=fac_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (RT)",
       y = "Standard composite difference scores (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.3f\")",  
                          r_scfe_fac_iso_rt_subt$r,
                          r_scfe_fac_iso_rt_subt$r_corr,
                          r_scfe_fac_iso_rt_subt$p))
```

#### Regressions
Accuracy
```{r}
r_scfe_fac_acc_regr <- bind_cols(hpe_acc['scfe_regr'],
                                 hpe_acc['fac_regr']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_regr ~ fac_regr",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_regr, rel_fac_d_regr),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_fac_acc_regr
```

```{r}
ggplot(hpe_acc, aes(x=fac_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (d')",
       y = "Standard composite residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_scfe_fac_acc_regr$r, 
                          r_scfe_fac_acc_regr$r_corr, 
                          r_scfe_fac_acc_regr$p))
```

Accuracy isolated
```{r}
r_scfe_fac_iso_acc_regr <- bind_cols(hpe_acc['scfe_regr'],
                                     hpe_acc['fac_regr_iso']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_regr ~ fac_regr_iso",
         DV = "acc",
         up_bound = upper_boundary(rel_scfe_acc_regr, rel_fac_d_iso_regr),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_fac_iso_acc_regr
```

```{r}
ggplot(hpe_acc, aes(x=fac_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (d')",
       y = "Standard composite residuals (accuracy)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.5f\")", 
                          r_scfe_fac_iso_acc_regr$r, 
                          r_scfe_fac_iso_acc_regr$r_corr, 
                          r_scfe_fac_iso_acc_regr$p))
```

RT
```{r}
r_scfe_fac_rt_regr <- bind_cols(hpe_rt['scfe_regr'],
                                hpe_rt['fac_regr']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_regr ~ fac_regr",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_regr, rel_fac_rt_regr),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_fac_rt_regr
```

```{r}
ggplot(hpe_rt, aes(x=fac_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (RT)",
       y = "Standard composite residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_scfe_fac_rt_regr$r, 
                          r_scfe_fac_rt_regr$r_corr, 
                          r_scfe_fac_rt_regr$p))
```

RT isolated
```{r}
r_scfe_fac_iso_rt_regr <- bind_cols(hpe_rt['scfe_regr'],
                                    hpe_rt['fac_regr_iso']) %>% 
  psych_cor2() %>% 
  rownames_to_column("pair") %>% 
  mutate(pair = "scfe_regr ~ fac_regr_iso",
         DV = "rt",
         up_bound = upper_boundary(rel_scfe_rt_regr, rel_fac_rt_iso_regr),
         r_corr = r/up_bound,
         .before = 1)
r_scfe_fac_iso_rt_regr
```

```{r}
ggplot(hpe_rt, aes(x=fac_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (RT)",
       y = "Standard composite residuals (RT)") +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          r_scfe_fac_iso_rt_regr$r, 
                          r_scfe_fac_iso_rt_regr$r_corr, 
                          r_scfe_fac_iso_rt_regr$p))
```

#### Interim summary

```{r}
r_sum_scfe_fac <- bind_rows(r_scfe_fac_acc_subt, r_scfe_fac_iso_acc_subt,
                            r_scfe_fac_rt_subt, r_scfe_fac_iso_rt_subt,
                            r_scfe_fac_acc_regr, r_scfe_fac_iso_acc_regr,
                            r_scfe_fac_rt_regr, r_scfe_fac_iso_rt_regr) 
```

Corrections for the baseline of isolated:
```{r}
r_scfe_fac_iso <- r_sum_scfe_fac %>% 
  filter(endsWith(pair, "_iso")) %>% 
  mutate(p.adj = p.adjust(p, method = "holm"),
         adjust="holm") %>%  # apply Holm-Bonferroni
  psych_cor1_adj_CI() %>% 
  mutate(effect = "SCFE ~ Facilitation")
r_scfe_fac_iso
```

```{r}
plot_scfe_fac_acc_subt_iso <- ggplot(hpe_acc, aes(x=fac_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation difference scores ("*italic("d'")*")"),
       y = "Standard composite difference scores (accuracy)     ") +
  coord_cartesian(ylim = c(-.65, .25)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_iso_acc_subt$r, 
                          r_scfe_fac_iso_acc_subt$r_corr, 
                          r_scfe_fac_iso_acc_subt$p,
                          r_scfe_fac_iso$p.adj[1]))
plot_scfe_fac_acc_subt_iso
```

```{r}
plot_scfe_fac_rt_subt_iso <- ggplot(hpe_rt, aes(x=fac_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (RT)",
       y = "Standard composite difference scores (RT)") +
  scale_x_continuous(breaks=seq(-500, 1000, 250)) +
  coord_cartesian(ylim = c(-1100, 600)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_iso_rt_subt$r, 
                          r_scfe_fac_iso_rt_subt$r_corr, 
                          r_scfe_fac_iso_rt_subt$p,
                          r_scfe_fac_iso$p.adj[2]))
plot_scfe_fac_rt_subt_iso
```

```{r}
plot_scfe_fac_acc_regr_iso <- ggplot(hpe_acc, aes(x=fac_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation residuals ("*italic("d'")*")"),
       y = "Standard composite residuals (accuracy)") +
  coord_cartesian(ylim = c(-.58, .21)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_iso_acc_regr$r, 
                          r_scfe_fac_iso_acc_regr$r_corr, 
                          r_scfe_fac_iso_acc_regr$p,
                          r_scfe_fac_iso$p.adj[3]))
plot_scfe_fac_acc_regr_iso
```

```{r}
plot_scfe_fac_rt_regr_iso <- ggplot(hpe_rt, aes(x=fac_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (RT)",
       y = "Standard composite residuals (RT)") +
  coord_cartesian(ylim = c(-730, 470), xlim = c(-750, 490)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_iso_rt_regr$r, 
                          r_scfe_fac_iso_rt_regr$r_corr, 
                          r_scfe_fac_iso_rt_regr$p,
                          r_scfe_fac_iso$p.adj[4]))
plot_scfe_fac_rt_regr_iso
```

```{r fig.width=12, fig.asp=1}
ggarrange(plot_scfe_fac_acc_subt_iso, plot_scfe_fac_rt_subt_iso,
          plot_scfe_fac_acc_regr_iso, plot_scfe_fac_rt_regr_iso,
          nrow=2, ncol=2)
```

Corrections for the misaligned baseline:
```{r}
r_scfe_fac <- r_sum_scfe_fac %>% 
  filter(!endsWith(pair, "_iso")) %>% 
  mutate(p.adj = p.adjust(p, method = "holm"),
         adjust="holm") %>%  # apply Holm-Bonferroni
  psych_cor1_adj_CI()
r_scfe_fac
```

```{r}
plot_scfe_fac_acc_subt <- ggplot(hpe_acc, aes(x=fac_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation difference scores ("*italic("d'")*")"),
       y = "Standard composite difference scores (accuracy)     ") +
  coord_cartesian(ylim = c(-.65, .24)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_acc_subt$r, 
                          r_scfe_fac_acc_subt$r_corr,
                          r_scfe_fac_acc_subt$p,
                          r_scfe_fac$p.adj[1]))
plot_scfe_fac_acc_subt
```

```{r}
plot_scfe_fac_rt_subt <- ggplot(hpe_rt, aes(x=fac_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation difference scores (RT)",
       y = "Standard composite difference scores (RT)") +
  coord_cartesian(ylim = c(-1100, 500)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_rt_subt$r, 
                          r_scfe_fac_rt_subt$r_corr, 
                          r_scfe_fac_rt_subt$p,
                          r_scfe_fac$p.adj[2]))
plot_scfe_fac_rt_subt
```

```{r}
plot_scfe_fac_acc_regr <- ggplot(hpe_acc, aes(x=fac_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation residuals ("*italic("d'")*")"),
       y = "Standard composite residuals (accuracy)") +
  coord_cartesian(ylim = c(-.56, .23)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_acc_regr$r, 
                          r_scfe_fac_acc_regr$r_corr, 
                          r_scfe_fac_acc_regr$p,
                          r_scfe_fac$p.adj[3]))
plot_scfe_fac_acc_regr
```

```{r}
plot_scfe_fac_rt_regr <- ggplot(hpe_rt, aes(x=fac_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = "Facilitation residuals (RT)",
       y = "Standard composite residuals (RT)") +
  scale_x_continuous(breaks=seq(-600, 600, 300)) +
  coord_cartesian(ylim = c(-720, 380), xlim = c(-620, 600)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_rt_regr$r, 
                          r_scfe_fac_rt_regr$r_corr,
                          r_scfe_fac_rt_regr$p,
                          r_scfe_fac$p.adj[4]))
plot_scfe_fac_rt_regr
```


```{r fig.width=12, fig.asp=1}
ggarrange(plot_scfe_fac_acc_subt, plot_scfe_fac_rt_subt,
          plot_scfe_fac_acc_regr, plot_scfe_fac_rt_regr,
          nrow=2, ncol=2)
```



## All pairwise correlations (just for fun)

### Behavioral choices

Correlations among effects (accuracy or d' with subtraction):
```{r fig.width=12, fig.asp=1}
hpe_acc %>% 
  select(-Subject, -contains("regr")) %>% 
  cor.plot()
```

Correlations among effects (accuracy or d' with regression):
```{r fig.width=12, fig.asp=1}
hpe_acc %>% 
  select(-Subject, -contains("subt"), ccfe_subt_regr) %>% 
  cor.plot()
```

### Response times

Correlations among effects (RT with subtraction):
```{r fig.width=12, fig.asp=1}
hpe_rt %>% 
  select(-Subject, -contains("regr")) %>% 
  cor.plot()
```

Correlations among effects (RT with regression):
```{r fig.width=12, fig.asp=1}
hpe_rt %>% 
  select(-Subject, -contains("subt"), ccfe_subt_regr) %>% 
  cor.plot()
```

## Tables

### Table 1: reliability

```{r}
rel_sum <- bind_rows(rel_sum_pw, rel_sum_scf, rel_sum_ccf) %>% 
  select(-niter)
# write_csv(rel_sum, "reliability_summary.csv")
rel_sum
```

```{r}
Stab_rel <- rel_sum %>% 
  mutate(DV = case_when(
    DV=="rt" ~ toupper(DV),
    DV=="acc" ~ "accuracy",
    DV=="d" ~ "d'"
  ),
  Reliability = round(Reliability, 2),
  Task = as_factor(Task),
  ) %>% 
  filter(!(Task=="CCF" & DV=="accuracy")) %>% 
  filter(!endsWith(Condition, " con_mis")) %>% 
  filter(Condition != "inc_ali - inc_mis") %>%
  filter(Condition != "inc_ali ~ inc_mis") %>%
  filter(!startsWith(Condition, "(con_ali ~ inc_ali)")) %>% 
  arrange(Task)
# write_csv(Stab_rel, "STab_reliability.csv")
Stab_rel
```



### Table 2: correlations

```{r}
cor_sum <- cor_hpe %>% 
  rename(upper = upper95,
         lower = lower95) %>% 
  mutate(effect = "Holistic Processing", .before=1) %>%  
  mutate(CI = .95) %>% 
  bind_rows(bind_rows(r_pwe_fac_iso, r_scfe_int_iso) %>% 
              rename(upper = upper90,
                     lower = lower90) %>% 
              mutate(CI = .90)) %>% 
  bind_rows(bind_rows(r_pwe_int_iso, r_scfe_fac_iso) %>% 
              rename(upper = upper95,
                     lower = lower95) %>% 
              mutate(CI = .95))
  
# write_csv(cor_sum, "correlation_summary.csv")
cor_sum
```


```{r}
stab_cor <- cor_sum %>% 
  separate(pair, c("pair1", "pair2"), " ~ ") %>% 
  mutate(method = if_else(endsWith(pair1, "subt"), "subtraction", 
                          if_else(endsWith(pair1, "regr"), "regression", "NA")),
         pair1 = str_remove(pair1, "e_\\D*"),
         pair2 = str_remove(pair2, "_\\D*")) %>% 
  transmute(
    Pair = case_when(
      pair2=="fac" ~ paste0("Facilitation ~ ", toupper(pair1)),
      pair2=="int" ~ paste0("Interference ~ ", toupper(pair1)),
      TRUE ~ paste(toupper(pair1), toupper(str_remove(pair2, "e")), sep=" ~ ")),
    Method = as_factor(method),
    DV = if_else(DV=="acc", "Accuracy or d'", "RT"),
    Max = round(up_bound, 2),
    r = round(r, 2),
    r_c = round(r_corr, 2),
    lower = round(lower, 2),
    upper = if_else(alt=="two.sided", round(upper, 2), 1),
    `p-value` = signif(p, 2),
    `p-adjust` = signif(p.adj, 2)) %>% 
  mutate(Pair = as_factor(Pair),
         Pair = fct_relevel(Pair, "Interference ~ PW", after = Inf)) %>% 
  arrange(Pair, Method)
# write_csv(stab_cor, "STab_correlations.csv")
stab_cor
```

## Figures (version 1)

### Figure 3: correlations among holistic processing effects

```{r fig.width=6, fig.asp=1}
fig_cor_hpe <-
  ggarrange(plot_pwe_scfe_acc_subt, plot_ccfe_pwe_acc_subt, plot_ccfe_scfe_acc_subt,
            plot_pwe_scfe_rt_subt, plot_ccfe_pwe_rt_subt, plot_ccfe_scfe_rt_subt,
            plot_pwe_scfe_acc_regr, plot_ccfe_pwe_acc_regr, plot_ccfe_scfe_acc_regr,
            plot_pwe_scfe_rt_regr, plot_ccfe_pwe_rt_regr, plot_ccfe_scfe_rt_regr,
            nrow = 4, ncol = 3)
# ggsave(here("figures", "fig_cor_hpe.pdf"), fig_cor_hpe, width = 15, height = 18)
# fig_cor_hpe
```

```{r fig.width=15, fig.asp=1}
fig_cor_hpe
```

```{r}
# fig_cor_hpe <-
#   ggarrange(plot_pwe_scfe_acc_subt, plot_pwe_scfe_rt_subt, plot_pwe_scfe_acc_regr, plot_pwe_scfe_rt_regr,
#             plot_ccfe_pwe_acc_subt, plot_ccfe_pwe_rt_subt, plot_ccfe_pwe_acc_regr, plot_ccfe_pwe_rt_regr,
#             plot_ccfe_scfe_acc_subt, plot_ccfe_scfe_rt_subt, plot_ccfe_scfe_acc_regr, plot_ccfe_scfe_rt_regr,
#             nrow = 3, ncol = 4)
# ggsave(here("figures", "fig_cor_hpe.pdf"), fig_cor_hpe, width = 20, height = 15)
# fig_cor_hpe
```

```{r fig.width=18, fig.asp=.75}
# fig_cor_hpe
```

Par-whole and standard composite
```{r fig.width=6, fig.asp=.9}
fig_cor_pwe_scfe <- 
  ggarrange(plot_pwe_scfe_acc_subt, plot_pwe_scfe_rt_subt,
            plot_pwe_scfe_acc_regr, plot_pwe_scfe_rt_regr, 
            labels = c("a", "b", "c", "d"),
            nrow = 2, ncol = 2)
# ggsave(here("figures", "fig_cor_pwe_scfe.pdf"), fig_cor_pwe_scfe, width = 10, height = 9)
# fig_cor_pwe_scfe
```

```{r fig.width=12, fig.asp=.9}
fig_cor_pwe_scfe
```

Complete composite and part-whole
```{r fig.width=6, fig.asp=.9}
fig_cor_ccfe_pwe <- 
  ggarrange(plot_ccfe_pwe_acc_subt, plot_ccfe_pwe_rt_subt,
            plot_ccfe_pwe_acc_regr, plot_ccfe_pwe_rt_regr, 
            labels = c("a", "b", "c", "d"),
            nrow = 2, ncol = 2)
# ggsave(here("figures", "fig_cor_ccfe_pwe.pdf"), fig_cor_ccfe_pwe, width = 10, height = 9)
# fig_cor_ccfe_pwe
```

```{r fig.width=12, fig.asp=.9}
fig_cor_ccfe_pwe
```


Complete and standard composite
```{r fig.width=6, fig.asp=.9}
fig_cor_ccfe_scfe <- 
  ggarrange(plot_ccfe_scfe_acc_subt, plot_ccfe_scfe_rt_subt,
            plot_ccfe_scfe_acc_regr, plot_ccfe_scfe_rt_regr, 
            labels = c("a", "b", "c", "d"),
            nrow = 2, ncol = 2)
# ggsave(here("figures", "fig_cor_ccfe_scfe.pdf"), fig_cor_ccfe_scfe, width = 10, height = 9)
# fig_cor_ccfe_scfe
```

```{r fig.width=12, fig.asp=.9}
fig_cor_ccfe_scfe
```

### Figure 4: correlations between facilitation and part-whole effect

Facilitation (isolated)
```{r fig.width=6, fig.asp=.9}
fig_cor_fac_iso <- ggarrange(plot_pwe_fac_acc_subt_iso, plot_pwe_fac_rt_subt_iso,
                             plot_pwe_fac_acc_regr_iso, plot_pwe_fac_rt_regr_iso,
                             labels = c("a", "b", "c", "d"),
                             nrow=2, ncol=2)
# ggsave(here("figures", "fig_cor_facilitation_iso.pdf"), fig_cor_fac_iso, width = 10, height = 9)
# fig_cor_fac_iso
```

```{r fig.width=12, fig.asp=.9}
fig_cor_fac_iso
```

Facilitation (misaligned)
```{r fig.width=6, fig.asp=.9}
fig_cor_fac <- ggarrange(plot_pwe_fac_acc_subt, plot_pwe_fac_rt_subt,
                         plot_pwe_fac_acc_regr, plot_pwe_fac_rt_regr,
                         labels = c("a", "b", "c", "d"),
                         nrow=2, ncol=2)
# ggsave(here("figures", "fig_cor_facilitation.pdf"), fig_cor_fac, width = 10, height = 9)
# fig_cor_fac
```

```{r fig.width=12, fig.asp=.9}
fig_cor_fac
```

### Figure 5: correlations between interference and standard composite effect

Interference (isolated)
```{r fig.width=6, fig.asp=.9}
fig_cor_int_iso <- ggarrange(plot_scfe_int_acc_subt_iso, plot_scfe_int_rt_subt_iso,
                             plot_scfe_int_acc_regr_iso, plot_scfe_int_rt_regr_iso,
                             labels = c("a", "b", "c", "d"),
                             nrow=2, ncol=2)
# ggsave(here("figures", "fig_cor_interference_iso.pdf"), fig_cor_int_iso, width = 10, height = 9)
# fig_cor_int_iso
```

```{r fig.width=12, fig.asp=.9}
fig_cor_int_iso
```

Interference (misaligned)
```{r fig.width=6, fig.asp=.9}
fig_cor_int <- ggarrange(plot_scfe_int_acc_subt, plot_scfe_int_rt_subt,
                         plot_scfe_int_acc_regr, plot_scfe_int_rt_regr,
                         labels = c("a", "b", "c", "d"),
                         nrow=2, ncol=2)
# ggsave(here("figures", "fig_cor_interference.pdf"), fig_cor_int, width = 10, height = 9)
# fig_cor_int
```

```{r fig.width=12, fig.asp=.9}
fig_cor_int
```

### Figure S: correlations between interference and part-whole effect

Interference ~ part-whole effect (isolated)
```{r fig.width=6, fig.asp=.9}
fig_cor_int_pwe_iso <- ggarrange(plot_pwe_int_acc_subt_iso, plot_pwe_int_rt_subt_iso,
                                 plot_pwe_int_acc_regr_iso, plot_pwe_int_rt_regr_iso,
                                 labels = c("a", "b", "c", "d"),
                                 nrow=2, ncol=2)
# ggsave(here("figures", "fig_cor_interference_pwe_iso.pdf"), fig_cor_int_pwe_iso, width = 10, height = 9)
# fig_cor_int_pwe_iso
```

```{r fig.width=12, fig.asp=.9}
fig_cor_int_pwe_iso
```

Interference ~ part-whole effect (misaligned)
```{r fig.width=6, fig.asp=.9}
fig_cor_int_pwe <- ggarrange(plot_pwe_int_acc_subt, plot_pwe_int_rt_subt,
                             plot_pwe_int_acc_regr, plot_pwe_int_rt_regr,
                             labels = c("a", "b", "c", "d"),
                             nrow=2, ncol=2)
# ggsave(here("figures", "fig_cor_interference_pwe.pdf"), fig_cor_int_pwe, width = 10, height = 9)
# fig_cor_int_pwe
```

```{r fig.width=12, fig.asp=.9}
fig_cor_int_pwe
```

### Figure S: correlations between facilitation and standard composite effect

Facilitation ~ standard composite effect (isolated)
```{r fig.width=6, fig.asp=.9}
fig_cor_fac_scfe_iso <- ggarrange(plot_scfe_fac_acc_subt_iso, plot_scfe_fac_rt_subt_iso,
                                  plot_scfe_fac_acc_regr_iso, plot_scfe_fac_rt_regr_iso,
                                  labels = c("a", "b", "c", "d"),
                                  nrow=2, ncol=2)
# ggsave(here("figures", "fig_cor_facilitation_scfe_iso.pdf"), fig_cor_fac_scfe_iso, width = 10, height = 9)
# fig_cor_fac_scfe_iso
```

```{r fig.width=12, fig.asp=.9}
fig_cor_fac_scfe_iso
```

Facilitation ~ standard composite effect (misaligned)
```{r fig.width=6, fig.asp=.9}
fig_cor_fac_scfe <- ggarrange(plot_scfe_fac_acc_subt, plot_scfe_fac_rt_subt,
                              plot_scfe_fac_acc_regr, plot_scfe_fac_rt_regr,
                              labels = c("a", "b", "c", "d"),
                              nrow=2, ncol=2)
# ggsave(here("figures", "fig_cor_facilitation_scfe.pdf"), fig_cor_fac_scfe, width = 10, height = 9)
# fig_cor_fac_scfe
```

```{r fig.width=12, fig.asp=.9}
fig_cor_fac_scfe
```

```{r eval=save_figure, include=FALSE}
# save all figures
ext <- "png"
ggsave(here("figures", paste0("fig_cor_pwe_scfe.", ext)), fig_cor_pwe_scfe, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_ccfe_pwe.", ext)), fig_cor_ccfe_pwe, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_ccfe_scfe.", ext)), fig_cor_ccfe_scfe, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_facilitation_iso.", ext)), fig_cor_fac_iso, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_facilitation.", ext)), fig_cor_fac, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_interference_iso.", ext)), fig_cor_int_iso, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_interference.", ext)), fig_cor_int, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_interference_pwe_iso.", ext)), fig_cor_int_pwe_iso, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_interference_pwe.", ext)), fig_cor_int_pwe, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_facilitation_scfe_iso.", ext)), fig_cor_fac_scfe_iso, width = 10, height = 9)
ggsave(here("figures", paste0("fig_cor_facilitation_scfe.", ext)), fig_cor_fac_scfe, width = 10, height = 9)
```

## Figure (version 2: combine complete and facilitation & interference)

### Individual figures

```{r}
lim_pwe_acc <- c(-.35, .35)
lim_scfe_acc <- c(-.3, .4)
lim_ccfe_d <- c(-3, 3)
```

#### Facilitation

```{r}
plot_ccfe_pwe_acc_subt <- ggplot(hpe_acc, aes(x=ccfe_subt_subt, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Complete composite difference scores ("*italic("d'")*")"), 
       y = "Part-whole difference scores (accuracy)") +
  coord_cartesian(ylim = lim_pwe_acc, xlim = lim_ccfe_d) +
  # coord_cartesian(ylim = c(-.35, .6)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f\")", 
                          cor_hpe_acc_subt$r[2], 
                          cor_hpe_acc_subt$r_corr[2], 
                          cor_hpe_acc_subt$p[2]))
plot_ccfe_pwe_acc_subt
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures","fig_ccfe_pwe_acc_subt.pdf"), 
       plot_ccfe_pwe_acc_subt, width = 5, height = 5*.9)
```


```{r}
plot_ccfe_pwe_acc_regr <- ggplot(hpe_acc, aes(x=ccfe_subt_regr, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Complete composite residuals ("*italic("d'")*")"), 
       y = "Part-whole residuals (accuracy)") +
  coord_cartesian(ylim = lim_pwe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.3f\")", 
                          cor_hpe_acc_regr$r[2], 
                          cor_hpe_acc_regr$r_corr[2], 
                          cor_hpe_acc_regr$p[2]))
plot_ccfe_pwe_acc_regr
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures","fig_ccfe_pwe_acc_regr.pdf"), 
       plot_ccfe_pwe_acc_regr, width = 5, height = 5*.9)
```


```{r}
plot_pwe_fac_acc_subt_iso <- ggplot(hpe_acc, aes(x=fac_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[1], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation difference scores ("*italic("d'")*")"),
       y = "Part-whole difference scores (accuracy)") +
  # scale_y_continuous(breaks=seq(-.2, .3, .1)) +
  # coord_cartesian(ylim = c(-.25, .36)) +
  coord_cartesian(ylim = lim_pwe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_fac_iso_acc_subt$r, 
                          r_pwe_fac_iso_acc_subt$r_corr, 
                          r_pwe_fac_iso_acc_subt$p,
                          r_pwe_fac_iso$p.adj[1]))
plot_pwe_fac_acc_subt_iso
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures","fig_pwe_fac_acc_subt.pdf"), 
       plot_pwe_fac_acc_subt_iso, width = 5, height = 5*.9)
```


```{r}
plot_pwe_fac_acc_regr_iso <-ggplot(hpe_acc, aes(x=fac_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[1], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation residuals ("*italic("d'")*")"),
       y = "Part-whole residuals (accuracy)") +
  # scale_x_continuous(breaks=seq(-2, 2, .5)) +
  # scale_y_continuous(breaks=seq(-.4, .2, .1)) +
  # coord_cartesian(ylim = c(-.35, .19)) +
  coord_cartesian(ylim = lim_pwe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_fac_iso_acc_regr$r, 
                          r_pwe_fac_iso_acc_regr$r_corr, 
                          r_pwe_fac_iso_acc_regr$p,
                          r_pwe_fac_iso$p.adj[3]))
plot_pwe_fac_acc_regr_iso
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures","fig_pwe_fac_acc_regr.pdf"), 
       plot_pwe_fac_acc_regr_iso, width = 5, height = 5*.9)
```


```{r}
plot_pwe_int_acc_subt_iso <- ggplot(hpe_acc, aes(x=int_subt_iso, y=pwe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference difference scores ("*italic("d'")*")"),
       y = "Part-whole difference scores (accuracy)") +
  # scale_y_continuous(breaks=seq(-.2, .3, .1)) +
  # coord_cartesian(ylim = c(-.25, .36)) +
  coord_cartesian(ylim = lim_pwe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_int_iso_acc_subt$r, 
                          r_pwe_int_iso_acc_subt$r_corr, 
                          r_pwe_int_iso_acc_subt$p,
                          r_pwe_int_iso$p.adj[1]))
plot_pwe_int_acc_subt_iso
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures","fig_pwe_int_acc_subt.pdf"), 
       plot_pwe_int_acc_subt_iso, width = 5, height = 5*.9)
```

```{r}
plot_pwe_int_acc_regr_iso <-ggplot(hpe_acc, aes(x=int_regr_iso, y=pwe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference residuals ("*italic("d'")*")"),
       y = "Part-whole residuals (accuracy)") +
  # scale_x_continuous(breaks=seq(-2, 2, .5)) +
  # scale_y_continuous(breaks=seq(-.4, .2, .1)) +
  # coord_cartesian(ylim = c(-.35, .19)) +
  coord_cartesian(ylim = lim_pwe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_pwe_int_iso_acc_regr$r, 
                          r_pwe_int_iso_acc_regr$r_corr, 
                          r_pwe_int_iso_acc_regr$p,
                          r_pwe_int_iso$p.adj[3]))
plot_pwe_int_acc_regr_iso
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures","fig_pwe_int_acc_regr.pdf"), 
       plot_pwe_int_acc_regr_iso, width = 5, height = 5*.9)
```

#### Interference

```{r}
plot_ccfe_scfe_acc_subt <- ggplot(hpe_acc, aes(x=ccfe_subt_subt, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Complete composite difference scores ("*italic("d'")*")"), 
       y = "Standard composite difference scores (accuracy)     ") +
  coord_cartesian(ylim = lim_scfe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.3f\")", 
                          cor_hpe_acc_subt$r[3], 
                          cor_hpe_acc_subt$r_corr[3], 
                          cor_hpe_acc_subt$p[3]))
plot_ccfe_scfe_acc_subt
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures","fig_ccfe_scfe_acc_subt.pdf"), 
       plot_ccfe_scfe_acc_subt, width = 5, height = 5*.9)
```


```{r}
plot_ccfe_scfe_acc_regr <- ggplot(hpe_acc, aes(x=ccfe_subt_regr, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Complete composite residuals ("*italic("d'")*")"), 
       y = "Standard composite residuals (accuracy)") +
  coord_cartesian(ylim = lim_scfe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.4f\")", 
                          cor_hpe_acc_regr$r[3], 
                          cor_hpe_acc_regr$r_corr[3], 
                          cor_hpe_acc_regr$p[3]))
plot_ccfe_scfe_acc_regr
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures", "fig_ccfe_scfe_acc_regr.pdf"), 
       plot_ccfe_scfe_acc_regr, width = 5, height = 5*.9)
```


```{r}
plot_scfe_int_acc_subt_iso <- ggplot(hpe_acc, aes(x=int_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[2], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference difference scores ("*italic("d'")*")"),
       y = "Standard composite difference scores (accuracy)     ") +
  coord_cartesian(ylim = lim_scfe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.5f, \",
                          italic(p)[adj], \" = %0.5f\")", 
                          r_scfe_int_iso_acc_subt$r, 
                          r_scfe_int_iso_acc_subt$r_corr, 
                          r_scfe_int_iso_acc_subt$p,
                          r_scfe_int_iso$p.adj[1]))
plot_scfe_int_acc_subt_iso
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures", "fig_scfe_int_acc_subt.pdf"), 
       plot_scfe_int_acc_subt_iso, width = 5, height = 5*.9)
```


```{r}
plot_scfe_int_acc_regr_iso <- ggplot(hpe_acc, aes(x=int_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[2], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Interference residuals ("*italic("d'")*")"),
       y = "Standard composite residuals (accuracy)") +
  coord_cartesian(ylim = lim_scfe_acc, xlim = lim_ccfe_d) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" < 0.00001, \",
                          italic(p)[adj], \" < 0.00001\")", 
                          r_scfe_int_iso_acc_regr$r,
                          r_scfe_int_iso_acc_regr$r_corr)) 
plot_scfe_int_acc_regr_iso
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures", "fig_scfe_int_acc_regr.pdf"), 
       plot_scfe_int_acc_regr_iso, width = 5, height = 5*.9)
```


```{r}
plot_scfe_fac_acc_subt_iso <- ggplot(hpe_acc, aes(x=fac_subt_iso, y=scfe_subt)) +
  geom_point(color=dark_colors[3], shape=subt_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation difference scores ("*italic("d'")*")"),
       y = "Standard composite difference scores (accuracy)     ") +
  coord_cartesian(ylim = lim_scfe_acc, xlim = lim_ccfe_d) +
  # coord_cartesian(ylim = c(-.65, .25)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_iso_acc_subt$r, 
                          r_scfe_fac_iso_acc_subt$r_corr, 
                          r_scfe_fac_iso_acc_subt$p,
                          r_scfe_fac_iso$p.adj[1]))
plot_scfe_fac_acc_subt_iso
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures", "fig_scfe_fac_acc_subt.pdf"), 
       plot_scfe_fac_acc_subt_iso, width = 5, height = 5*.9)
```


```{r}
plot_scfe_fac_acc_regr_iso <- ggplot(hpe_acc, aes(x=fac_regr_iso, y=scfe_regr)) +
  geom_point(color=dark_colors[3], shape=regr_shape) + 
  geom_smooth(color="black", method=lm, formula='y ~ x') +
  labs(x = expression("Facilitation residuals ("*italic("d'")*")"),
       y = "Standard composite residuals (accuracy)") +
  coord_cartesian(ylim = lim_scfe_acc, xlim = lim_ccfe_d) +
  # coord_cartesian(ylim = c(-.58, .21)) +
  annotate("text", x=Inf, y=-Inf, hjust = 1.1, vjust = -.5, parse = TRUE,
           label= sprintf("paste(italic(r), \" = %0.2f, \",
                          italic(r)[c], \" = %0.2f, \",
                          italic(p), \" = %0.2f, \",
                          italic(p)[adj], \" = %0.2f\")", 
                          r_scfe_fac_iso_acc_regr$r, 
                          r_scfe_fac_iso_acc_regr$r_corr, 
                          r_scfe_fac_iso_acc_regr$p,
                          r_scfe_fac_iso$p.adj[3]))
plot_scfe_fac_acc_regr_iso
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures", "fig_scfe_fac_acc_regr.pdf"), 
       plot_scfe_fac_acc_regr_iso, width = 5, height = 5*.9)
```

```{r fig.width=22, fig.asp=.5}
fig_corr_poster <- 
  ggarrange(ggarrange(plot_ccfe_pwe_acc_subt, plot_ccfe_pwe_acc_regr, nrow=1),
            ggplot() + theme_void(), 
            ggarrange(plot_ccfe_scfe_acc_subt, plot_ccfe_scfe_acc_regr, nrow=1),
            ggplot() + theme_void(), 
            ggplot() + theme_void(), 
            ggplot() + theme_void(), 
            ggarrange(plot_pwe_fac_acc_subt_iso, plot_pwe_fac_acc_regr_iso, nrow=1),
            ggplot() + theme_void(), 
            ggarrange(plot_scfe_int_acc_subt_iso, plot_scfe_int_acc_regr_iso, nrow=1),
            widths = c(1, 0.1, 1),
            heights = c(1, 0.1, 1),
            nrow=3, ncol=3) +
  bgcolor("white") +
  border("white")

fig_corr_poster
```

```{r eval=save_figure, include=FALSE}
ggsave(filename = here("figures","fig_cor_poster.pdf"), 
       fig_corr_poster, width = 23, height = 23*.46)
```

### Facilitation, CCF and PW

```{r fig.width=11, fig.asp=1}
fig_corr_faci <- 
  ggarrange(ggarrange(plot_ccfe_pwe_acc_subt, plot_ccfe_pwe_acc_regr, nrow=1) %>% 
                annotate_figure(top = text_grob("Correlations between holistic effects in the compolete composite task and the part-whole task", 
                                                face="bold", size = 12)),
            ggplot() + theme_void(), 
            ggarrange(plot_pwe_fac_acc_subt_iso, plot_pwe_fac_acc_regr_iso, nrow=1) %>% 
                annotate_figure(top = text_grob("Correlations between facilitation in the compolete composite task and the part-whole task", 
                                                face="bold", size = 12)),
            heights = c(1, 0.1, 1),
            labels = c("a", "", "b"),
            nrow=3) +
  bgcolor("white") +
  border("white")

fig_corr_faci
```

```{r eval=TRUE, include=FALSE}
ggsave(filename = here("figures","fig_cor_facilitation.pdf"), 
       fig_corr_faci, width = 10, height = 10*1)
```


### Interference, CCF and SCF

```{r fig.width=11, fig.asp=1}
fig_corr_inte <- 
  ggarrange(ggarrange(plot_ccfe_scfe_acc_subt, plot_ccfe_scfe_acc_regr, nrow=1) %>% 
                annotate_figure(top = text_grob("Correlations between holistic effects in the compolete composite task and the standard composite task", 
                                                face="bold", size = 12)),
            ggplot() + theme_void(), 
            ggarrange(plot_scfe_int_acc_subt_iso, plot_scfe_int_acc_regr_iso, nrow=1) %>% 
                annotate_figure(top = text_grob("Correlations between interference in the compolete composite task and the standard composite task", 
                                                face="bold", size = 12)),
            heights = c(1, 0.1, 1),
            labels = c("a", "", "b"),
            nrow=3) +
  bgcolor("white") +
  border("white")

fig_corr_inte
```

```{r eval=TRUE, include=FALSE}
ggsave(filename = here("figures","fig_cor_interference.pdf"), 
       fig_corr_inte, width = 10, height = 10*1)
```

